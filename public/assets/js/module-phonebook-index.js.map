{"version":3,"sources":["src/module-phonebook-index.js"],"names":["ModulePhoneBook","$formObj","$","$checkBoxes","$disabilityFields","$statusToggle","$moduleStatus","$globalSearch","$recordsTable","$addNewButton","inputNumberJQTPL","getNewRecordsAJAXUrl","globalRootUrl","deleteRecordAJAXUrl","saveRecordAJAXUrl","$maskList","validateRules","initialize","checkStatusToggle","window","addEventListener","on","e","keyCode","val","length","text","applyFilter","dataTable","search","serverSide","processing","ajax","url","type","dataSrc","columns","data","paging","sDom","deferRender","pageLength","createdRow","row","templateName","call_id","templateCid","number","templateDeleteButton","DT_RowId","globalTranslate","bt_ToolTipDelete","eq","html","drawCallback","initializeInputmask","language","SemanticLocalization","dataTableLocalisation","ordering","DataTable","closest","removeClass","currentRowId","target","attr","transition","addClass","document","which","hasClass","$el","each","index","obj","undefined","sendChangesToServer","preventDefault","id","deleteRow","remove","Math","floor","random","rowTemplate","find","before","focus","recordId","callerIdInputVal","numberInputVal","replace","substr","number_rep","api","method","successTest","response","Object","keys","success","onSuccess","oldId","newId","onFailure","message","UserMessage","showMultiString","onError","errorMessage","element","xhr","status","location","masksSort","InputMaskPatterns","inputmasks","inputmask","definitions","validator","cardinality","showMaskOnHover","onBeforePaste","cbOnNumberBeforePaste","match","list","listKey","checkbox","show","hide","$changedFields","$input","draw","pastedValue","$target","append","ready"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAEA,IAAMA,eAAe,GAAG;AACvBC,EAAAA,QAAQ,EAAEC,CAAC,CAAC,wBAAD,CADY;AAEvBC,EAAAA,WAAW,EAAED,CAAC,CAAC,qCAAD,CAFS;AAGvBE,EAAAA,iBAAiB,EAAEF,CAAC,CAAC,qCAAD,CAHG;AAIvBG,EAAAA,aAAa,EAAEH,CAAC,CAAC,uBAAD,CAJO;AAKvBI,EAAAA,aAAa,EAAEJ,CAAC,CAAC,SAAD,CALO;AAMvBK,EAAAA,aAAa,EAAEL,CAAC,CAAC,eAAD,CANO;AAOvBM,EAAAA,aAAa,EAAEN,CAAC,CAAC,kBAAD,CAPO;AAQvBO,EAAAA,aAAa,EAAEP,CAAC,CAAC,iBAAD,CARO;AASvBQ,EAAAA,gBAAgB,EAAE,oBATK;AAUvBC,EAAAA,oBAAoB,YAAKC,aAAL,oCAVG;AAWvBC,EAAAA,mBAAmB,YAAKD,aAAL,6BAXI;AAYvBE,EAAAA,iBAAiB,YAAKF,aAAL,2BAZM;AAavBG,EAAAA,SAAS,EAAE,IAbY;AAcvBC,EAAAA,aAAa,EAAE,EAdQ;AAgBvBC,EAAAA,UAhBuB,wBAgBV;AACZjB,IAAAA,eAAe,CAACkB,iBAAhB;AACAC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,qBAAxB,EAA+CpB,eAAe,CAACkB,iBAA/D,EAFY,CAIZ;;AACAlB,IAAAA,eAAe,CAACO,aAAhB,CAA8Bc,EAA9B,CAAiC,OAAjC,EAA0C,UAACC,CAAD,EAAO;AAChD,UAAIA,CAAC,CAACC,OAAF,KAAc,EAAd,IACAD,CAAC,CAACC,OAAF,KAAc,CADd,IAEAvB,eAAe,CAACO,aAAhB,CAA8BiB,GAA9B,GAAoCC,MAApC,KAA+C,CAFnD,EAEsD;AACrD,YAAMC,IAAI,aAAM1B,eAAe,CAACO,aAAhB,CAA8BiB,GAA9B,EAAN,CAAV;AACAxB,QAAAA,eAAe,CAAC2B,WAAhB,CAA4BD,IAA5B;AACA;AACD,KAPD,EALY,CAcZ;;AACA1B,IAAAA,eAAe,CAACQ,aAAhB,CAA8BoB,SAA9B,CAAwC;AACvCC,MAAAA,MAAM,EAAE;AACPA,QAAAA,MAAM,EAAE7B,eAAe,CAACO,aAAhB,CAA8BiB,GAA9B;AADD,OAD+B;AAIvCM,MAAAA,UAAU,EAAE,IAJ2B;AAKvCC,MAAAA,UAAU,EAAE,IAL2B;AAMvCC,MAAAA,IAAI,EAAE;AACLC,QAAAA,GAAG,EAAEjC,eAAe,CAACW,oBADhB;AAELuB,QAAAA,IAAI,EAAE,MAFD;AAGLC,QAAAA,OAAO,EAAE;AAHJ,OANiC;AAWvCC,MAAAA,OAAO,EAAE,CACR;AAAEC,QAAAA,IAAI,EAAE;AAAR,OADQ,EAER;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAFQ,EAGR;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAHQ,EAIR;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAJQ,CAX8B;AAiBvCC,MAAAA,MAAM,EAAE,IAjB+B;AAkBvC;AACA;AACAC,MAAAA,IAAI,EAAE,MApBiC;AAqBvCC,MAAAA,WAAW,EAAE,IArB0B;AAsBvCC,MAAAA,UAAU,EAAE,EAtB2B;AAwBvC;AACA;;AACA;AACH;AACA;AACA;AACA;AACGC,MAAAA,UA/BuC,sBA+B5BC,GA/B4B,EA+BvBN,IA/BuB,EA+BjB;AACrB,YAAMO,YAAY,GACjB,+HAC0DP,IAAI,CAACQ,OAD/D,wBACkFR,IAAI,CAACQ,OADvF,WAEA,QAHD;AAKA,YAAMC,WAAW,GAChB,sHACuDT,IAAI,CAACU,MAD5D,wBAC8EV,IAAI,CAACU,MADnF,WAEA,QAHD;AAKA,YAAMC,oBAAoB,GAAG,iFAChBhD,eAAe,CAACa,mBADA,cACuBwB,IAAI,CAACY,QAD5B,+BACuDZ,IAAI,CAACY,QAD5D,wFAEwCC,eAAe,CAACC,gBAFxD,WAG5B,0CAHD;AAKAjD,QAAAA,CAAC,CAAC,IAAD,EAAOyC,GAAP,CAAD,CAAaS,EAAb,CAAgB,CAAhB,EAAmBC,IAAnB,CAAwB,qCAAxB;AACAnD,QAAAA,CAAC,CAAC,IAAD,EAAOyC,GAAP,CAAD,CAAaS,EAAb,CAAgB,CAAhB,EAAmBC,IAAnB,CAAwBT,YAAxB;AACA1C,QAAAA,CAAC,CAAC,IAAD,EAAOyC,GAAP,CAAD,CAAaS,EAAb,CAAgB,CAAhB,EAAmBC,IAAnB,CAAwBP,WAAxB;AACA5C,QAAAA,CAAC,CAAC,IAAD,EAAOyC,GAAP,CAAD,CAAaS,EAAb,CAAgB,CAAhB,EAAmBC,IAAnB,CAAwBL,oBAAxB;AACA,OAnDsC;;AAoDvC;AACH;AACA;AACGM,MAAAA,YAvDuC,0BAuDxB;AACdtD,QAAAA,eAAe,CAACuD,mBAAhB,CAAoCrD,CAAC,CAACF,eAAe,CAACU,gBAAjB,CAArC;AACA,OAzDsC;AA0DvC8C,MAAAA,QAAQ,EAAEC,oBAAoB,CAACC,qBA1DQ;AA2DvCC,MAAAA,QAAQ,EAAE;AA3D6B,KAAxC;AA6DA3D,IAAAA,eAAe,CAAC4B,SAAhB,GAA4B5B,eAAe,CAACQ,aAAhB,CAA8BoD,SAA9B,EAA5B;AAEA5D,IAAAA,eAAe,CAAC4B,SAAhB,CAA0BP,EAA1B,CAA6B,MAA7B,EAAqC,YAAM;AAC1CrB,MAAAA,eAAe,CAACO,aAAhB,CAA8BsD,OAA9B,CAAsC,KAAtC,EAA6CC,WAA7C,CAAyD,SAAzD;AACA,KAFD,EA9EY,CAkFZ;;AACA5D,IAAAA,CAAC,CAAC,MAAD,CAAD,CAAUmB,EAAV,CAAa,SAAb,EAAwB,iCAAxB,EAA2D,UAACC,CAAD,EAAO;AACjE,UAAMyC,YAAY,GAAG7D,CAAC,CAACoB,CAAC,CAAC0C,MAAH,CAAD,CAAYH,OAAZ,CAAoB,IAApB,EAA0BI,IAA1B,CAA+B,IAA/B,CAArB;AACA/D,MAAAA,CAAC,CAACoB,CAAC,CAAC0C,MAAH,CAAD,CAAYE,UAAZ,CAAuB,MAAvB;AAEAhE,MAAAA,CAAC,CAACoB,CAAC,CAAC0C,MAAH,CAAD,CAAYH,OAAZ,CAAoB,KAApB,EACEC,WADF,CACc,aADd,EAEEK,QAFF,CAEW,eAFX;AAGAjE,MAAAA,CAAC,CAACoB,CAAC,CAAC0C,MAAH,CAAD,CAAYC,IAAZ,CAAiB,UAAjB,EAA6B,KAA7B;AACA,KARD,EAnFY,CA6FZ;;AACA/D,IAAAA,CAAC,CAACkE,QAAD,CAAD,CAAY/C,EAAZ,CAAe,SAAf,EAA0B,UAACC,CAAD,EAAO;AAChC,UAAMC,OAAO,GAAGD,CAAC,CAACC,OAAF,IAAaD,CAAC,CAAC+C,KAA/B;;AACA,UAAI9C,OAAO,KAAK,EAAZ,IACAA,OAAO,KAAK,CAAZ,IAAiB,CAACrB,CAAC,CAAC,QAAD,CAAD,CAAYoE,QAAZ,CAAqB,eAArB,CADtB,EAEE;AACD,YAAMC,GAAG,GAAGrE,CAAC,CAAC,gBAAD,CAAD,CAAoB2D,OAApB,CAA4B,IAA5B,CAAZ;AACAU,QAAAA,GAAG,CAACC,IAAJ,CAAS,UAACC,KAAD,EAAQC,GAAR,EAAgB;AACxB,cAAMX,YAAY,GAAG7D,CAAC,CAACwE,GAAD,CAAD,CAAOT,IAAP,CAAY,IAAZ,CAArB;;AACA,cAAIF,YAAY,KAAKY,SAArB,EAAgC;AAC/B3E,YAAAA,eAAe,CAAC4E,mBAAhB,CAAoCb,YAApC;AACA;AACD,SALD;AAMA;AACD,KAbD,EA9FY,CA6GZ;;AACA7D,IAAAA,CAAC,CAAC,MAAD,CAAD,CAAUmB,EAAV,CAAa,UAAb,EAAyB,iCAAzB,EAA4D,YAAM;AAChE,UAAMkD,GAAG,GAAGrE,CAAC,CAAC,gBAAD,CAAD,CAAoB2D,OAApB,CAA4B,IAA5B,CAAZ;AACAU,MAAAA,GAAG,CAACC,IAAJ,CAAS,UAACC,KAAD,EAAQC,GAAR,EAAgB;AACxB,YAAMX,YAAY,GAAG7D,CAAC,CAACwE,GAAD,CAAD,CAAOT,IAAP,CAAY,IAAZ,CAArB;;AACA,YAAIF,YAAY,KAAKY,SAArB,EAAgC;AAC/B3E,UAAAA,eAAe,CAAC4E,mBAAhB,CAAoCb,YAApC;AACA;AACD,OALD;AAMD,KARD,EA9GY,CAwHZ;;AACA7D,IAAAA,CAAC,CAAC,MAAD,CAAD,CAAUmB,EAAV,CAAa,OAAb,EAAsB,UAAtB,EAAkC,UAACC,CAAD,EAAO;AACxCA,MAAAA,CAAC,CAACuD,cAAF;AACA,UAAMC,EAAE,GAAG5E,CAAC,CAACoB,CAAC,CAAC0C,MAAH,CAAD,CAAYH,OAAZ,CAAoB,GAApB,EAAyBI,IAAzB,CAA8B,YAA9B,CAAX;AACAjE,MAAAA,eAAe,CAAC+E,SAAhB,CAA0B7E,CAAC,CAACoB,CAAC,CAAC0C,MAAH,CAA3B,EAAuCc,EAAvC;AACA,KAJD,EAzHY,CA+HZ;;AACA9E,IAAAA,eAAe,CAACS,aAAhB,CAA8BY,EAA9B,CAAiC,OAAjC,EAA0C,UAACC,CAAD,EAAO;AAChDA,MAAAA,CAAC,CAACuD,cAAF;AACA3E,MAAAA,CAAC,CAAC,mBAAD,CAAD,CAAuB8E,MAAvB,GAFgD,CAGhD;;AACA,UAAMT,GAAG,GAAGrE,CAAC,CAAC,gBAAD,CAAD,CAAoB2D,OAApB,CAA4B,IAA5B,CAAZ;AACAU,MAAAA,GAAG,CAACC,IAAJ,CAAS,UAACC,KAAD,EAAQC,GAAR,EAAgB;AACxB,YAAMX,YAAY,GAAG7D,CAAC,CAACwE,GAAD,CAAD,CAAOT,IAAP,CAAY,IAAZ,CAArB;;AACA,YAAIF,YAAY,KAAKY,SAArB,EAAgC;AAC/B3E,UAAAA,eAAe,CAAC4E,mBAAhB,CAAoCb,YAApC;AACA;AACD,OALD;AAOA,UAAMe,EAAE,gBAASG,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBF,IAAI,CAACC,KAAL,CAAW,GAAX,CAA3B,CAAT,CAAR;AACA,UAAME,WAAW,GAAG,mBAAWN,EAAX,WACnB,8CADmB,GAEnB,yIAFmB,GAGnB,sIAHmB,GAInB,8DAJmB,mHAKgF5B,eAAe,CAACC,gBALhG,WAMlB,+CANkB,GAOnB,OAPD;AAQAnD,MAAAA,eAAe,CAACQ,aAAhB,CAA8B6E,IAA9B,CAAmC,kBAAnC,EAAuDC,MAAvD,CAA8DF,WAA9D;AACAlF,MAAAA,CAAC,cAAO4E,EAAP,YAAD,CAAoBZ,UAApB,CAA+B,MAA/B;AACAhE,MAAAA,CAAC,cAAO4E,EAAP,uBAAD,CAA+BS,KAA/B;AACAvF,MAAAA,eAAe,CAACuD,mBAAhB,CAAoCrD,CAAC,cAAO4E,EAAP,oBAArC;AACA,KAzBD;AA0BA,GA1KsB;;AA2KvB;AACD;AACA;AACCF,EAAAA,mBA9KuB,+BA8KHY,QA9KG,EA8KO;AAE7B,QAAMC,gBAAgB,GAAGvF,CAAC,cAAOsF,QAAP,uBAAD,CAAqChE,GAArC,EAAzB;AACA,QAAMkE,cAAc,GAAGxF,CAAC,cAAOsF,QAAP,oBAAD,CAAkChE,GAAlC,EAAvB;;AACA,QAAI,CAACiE,gBAAD,IAAqB,CAACC,cAA1B,EAAyC;AACxC;AACA;;AACD,QAAI3C,MAAM,GAAG2C,cAAc,CAACC,OAAf,CAAuB,MAAvB,EAA+B,EAA/B,CAAb;AACA5C,IAAAA,MAAM,cAAKA,MAAM,CAAC6C,MAAP,CAAc7C,MAAM,CAACtB,MAAP,GAAgB,CAA9B,CAAL,CAAN;AACA,QAAMY,IAAI,GAAG;AACZQ,MAAAA,OAAO,EAAE4C,gBADG;AAEZI,MAAAA,UAAU,EAAEH,cAFA;AAGZ3C,MAAAA,MAAM,EAAEA,MAHI;AAIZ+B,MAAAA,EAAE,EAAEU;AAJQ,KAAb,CAT6B,CAgB7B;;AACAtF,IAAAA,CAAC,cAAOsF,QAAP,mBAAD,CACE1B,WADF,CACc,aADd,EAEEK,QAFF,CAEW,iBAFX;AAIAjE,IAAAA,CAAC,CAAC4F,GAAF,CAAM;AACL7D,MAAAA,GAAG,EAAEjC,eAAe,CAACc,iBADhB;AAELO,MAAAA,EAAE,EAAE,KAFC;AAGL0E,MAAAA,MAAM,EAAE,MAHH;AAIL1D,MAAAA,IAAI,EAAJA,IAJK;AAKL2D,MAAAA,WALK,uBAKOC,QALP,EAKiB;AACrB;AACA,eAAOA,QAAQ,KAAKtB,SAAb,IACHuB,MAAM,CAACC,IAAP,CAAYF,QAAZ,EAAsBxE,MAAtB,GAA+B,CAD5B,IAEHwE,QAAQ,CAACG,OAAT,KAAqB,IAFzB;AAGA,OAVI;AAWLC,MAAAA,SAXK,qBAWKJ,QAXL,EAWe;AACnB,YAAIA,QAAQ,CAAC5D,IAAT,KAAkBsC,SAAtB,EAAiC;AAChC,cAAI2B,KAAK,GAAGL,QAAQ,CAAC5D,IAAT,CAAciE,KAA1B;;AACA,cAAIA,KAAK,KAAG,IAAZ,EAAiB;AAChBA,YAAAA,KAAK,GAAGd,QAAR;AACA;;AAEDtF,UAAAA,CAAC,cAAOoG,KAAP,YAAD,CAAuBrC,IAAvB,CAA4B,UAA5B,EAAwC,IAAxC;AACA/D,UAAAA,CAAC,cAAOoG,KAAP,UAAD,CAAqBxC,WAArB,CAAiC,uBAAjC,EAA0DK,QAA1D,CAAmE,aAAnE,EAPgC,CAQhC;;AACAjE,UAAAA,CAAC,cAAOoG,KAAP,uBAAD,CACEnC,QADF,CACW,aADX,EAEEL,WAFF,CAEc,iBAFd;;AAGA,cAAIwC,KAAK,KAAKL,QAAQ,CAAC5D,IAAT,CAAckE,KAA5B,EAAkC;AACjCrG,YAAAA,CAAC,cAAOoG,KAAP,EAAD,CAAiBrC,IAAjB,CAAsB,IAAtB,EAA4BgC,QAAQ,CAAC5D,IAAT,CAAckE,KAA1C;AACA;AACD;AACD,OA5BI;AA6BLC,MAAAA,SA7BK,qBA6BKP,QA7BL,EA6Be;AACnB,YAAIA,QAAQ,CAACQ,OAAT,KAAqB9B,SAAzB,EAAoC;AACnC+B,UAAAA,WAAW,CAACC,eAAZ,CAA4BV,QAAQ,CAACQ,OAArC;AACA;;AACDvG,QAAAA,CAAC,cAAOsF,QAAP,uBAAD,CACErB,QADF,CACW,aADX,EAEEL,WAFF,CAEc,iBAFd;AAGA,OApCI;AAqCL8C,MAAAA,OArCK,mBAqCGC,YArCH,EAqCiBC,OArCjB,EAqC0BC,GArC1B,EAqC+B;AACnC,YAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACvB7F,UAAAA,MAAM,CAAC8F,QAAP,aAAqBrG,aAArB;AACA;AACD;AAzCI,KAAN;AA2CA,GA9OsB;;AA+OvB;AACD;AACA;AACC2C,EAAAA,mBAlPuB,+BAkPHgB,GAlPG,EAkPE;AACxB,QAAIvE,eAAe,CAACe,SAAhB,KAA8B,IAAlC,EAAwC;AACvC;AACAf,MAAAA,eAAe,CAACe,SAAhB,GAA4Bb,CAAC,CAACgH,SAAF,CAAYC,iBAAZ,EAA+B,CAAC,GAAD,CAA/B,EAAsC,SAAtC,EAAiD,MAAjD,CAA5B;AACA;;AACD5C,IAAAA,GAAG,CAAC6C,UAAJ,CAAe;AACdC,MAAAA,SAAS,EAAE;AACVC,QAAAA,WAAW,EAAE;AACZ,eAAK;AACJC,YAAAA,SAAS,EAAE,OADP;AAEJC,YAAAA,WAAW,EAAE;AAFT;AADO,SADH;AAOVC,QAAAA,eAAe,EAAE,KAPP;AAQV;AACA;AACA;AACAC,QAAAA,aAAa,EAAE1H,eAAe,CAAC2H,qBAXrB,CAYV;;AAZU,OADG;AAedC,MAAAA,KAAK,EAAE,OAfO;AAgBdjC,MAAAA,OAAO,EAAE,GAhBK;AAiBdkC,MAAAA,IAAI,EAAE7H,eAAe,CAACe,SAjBR;AAkBd+G,MAAAA,OAAO,EAAE;AAlBK,KAAf;AAqBA,GA5QsB;;AA6QvB;AACD;AACA;AACC5G,EAAAA,iBAhRuB,+BAgRH;AACnB,QAAIlB,eAAe,CAACK,aAAhB,CAA8B0H,QAA9B,CAAuC,YAAvC,CAAJ,EAA0D;AACzD/H,MAAAA,eAAe,CAACI,iBAAhB,CAAkC0D,WAAlC,CAA8C,UAA9C;AACA9D,MAAAA,eAAe,CAACM,aAAhB,CAA8B0H,IAA9B;AACA,KAHD,MAGO;AACNhI,MAAAA,eAAe,CAACI,iBAAhB,CAAkC+D,QAAlC,CAA2C,UAA3C;AACAnE,MAAAA,eAAe,CAACM,aAAhB,CAA8B2H,IAA9B;AACA;AACD,GAxRsB;;AAyRvB;AACD;AACA;AACA;AACCtG,EAAAA,WA7RuB,uBA6RXD,IA7RW,EA6RL;AACjB,QAAMwG,cAAc,GAAGhI,CAAC,CAAC,gBAAD,CAAxB;AACAgI,IAAAA,cAAc,CAAC1D,IAAf,CAAoB,UAACC,KAAD,EAAQC,GAAR,EAAgB;AACnCxE,MAAAA,CAAC,CAACwE,GAAD,CAAD,CAAOZ,WAAP,CAAmB,eAAnB,EAAoCK,QAApC,CAA6C,aAA7C;AACA,UAAMgE,MAAM,GAAGjI,CAAC,CAACwE,GAAD,CAAD,CAAOW,IAAP,CAAY,OAAZ,CAAf;AACA8C,MAAAA,MAAM,CAAC3G,GAAP,CAAW2G,MAAM,CAAClE,IAAP,CAAY,YAAZ,CAAX;AACAkE,MAAAA,MAAM,CAAClE,IAAP,CAAY,UAAZ,EAAwB,IAAxB;AACA,KALD;AAMAjE,IAAAA,eAAe,CAAC4B,SAAhB,CAA0BC,MAA1B,CAAiCH,IAAjC,EAAuC0G,IAAvC;AACApI,IAAAA,eAAe,CAACO,aAAhB,CAA8BsD,OAA9B,CAAsC,KAAtC,EAA6CM,QAA7C,CAAsD,SAAtD;AACA,GAvSsB;;AAwSvB;AACD;AACA;AACA;AACCwD,EAAAA,qBA5SuB,iCA4SDU,WA5SC,EA4SY;AAClC,WAAOA,WAAW,CAAC1C,OAAZ,CAAoB,MAApB,EAA4B,EAA5B,CAAP;AACA,GA9SsB;;AA+SvB;AACD;AACA;AACA;AACA;AACCZ,EAAAA,SApTuB,qBAoTbuD,OApTa,EAoTJxD,EApTI,EAoTA;AACtB,QAAIA,EAAE,KAAK,KAAX,EAAkB;AACjBwD,MAAAA,OAAO,CAACzE,OAAR,CAAgB,IAAhB,EAAsBmB,MAAtB;AACA;AACA;;AACD9E,IAAAA,CAAC,CAAC4F,GAAF,CAAM;AACL7D,MAAAA,GAAG,YAAKrB,aAAL,sCAA8CkE,EAA9C,CADE;AAELzD,MAAAA,EAAE,EAAE,KAFC;AAGLgF,MAAAA,SAHK,qBAGKJ,QAHL,EAGe;AACnB,YAAIA,QAAQ,CAACG,OAAb,EAAsB;AACrBkC,UAAAA,OAAO,CAACzE,OAAR,CAAgB,IAAhB,EAAsBmB,MAAtB;;AACA,cAAIhF,eAAe,CAACQ,aAAhB,CAA8B6E,IAA9B,CAAmC,YAAnC,EAAiD5D,MAAjD,KAA0D,CAA9D,EAAgE;AAC/DzB,YAAAA,eAAe,CAACQ,aAAhB,CAA8B6E,IAA9B,CAAmC,OAAnC,EAA4CkD,MAA5C,CAAmD,uBAAnD;AACA;AACD;AACD;AAVI,KAAN;AAYA;AArUsB,CAAxB;AAwUArI,CAAC,CAACkE,QAAD,CAAD,CAAYoE,KAAZ,CAAkB,YAAM;AACvBxI,EAAAA,eAAe,CAACiB,UAAhB;AACA,CAFD","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n *\n */\n\n/* global globalRootUrl,globalTranslate,\nSemanticLocalization, UserMessage, InputMaskPatterns */ \n\nconst ModulePhoneBook = {\n\t$formObj: $('#module-phonebook-form'),\n\t$checkBoxes: $('#module-phonebook-form .ui.checkbox'),\n\t$disabilityFields: $('#module-phonebook-form  .disability'),\n\t$statusToggle: $('#module-status-toggle'),\n\t$moduleStatus: $('#status'),\n\t$globalSearch: $('#globalsearch'),\n\t$recordsTable: $('#phonebook-table'),\n\t$addNewButton: $('#add-new-button'),\n\tinputNumberJQTPL: 'input.number-input',\n\tgetNewRecordsAJAXUrl: `${globalRootUrl}module-phone-book/getNewRecords`,\n\tdeleteRecordAJAXUrl: `${globalRootUrl}module-phone-book/delete`,\n\tsaveRecordAJAXUrl: `${globalRootUrl}module-phone-book/save`,\n\t$maskList: null,\n\tvalidateRules: {\n\t},\n\tinitialize() {\n\t\tModulePhoneBook.checkStatusToggle();\n\t\twindow.addEventListener('ModuleStatusChanged', ModulePhoneBook.checkStatusToggle);\n\n\t\t// Global Search filter\n\t\tModulePhoneBook.$globalSearch.on('keyup', (e) => {\n\t\t\tif (e.keyCode === 13\n\t\t\t\t|| e.keyCode === 8\n\t\t\t\t|| ModulePhoneBook.$globalSearch.val().length === 0) {\n\t\t\t\tconst text = `${ModulePhoneBook.$globalSearch.val()}`;\n\t\t\t\tModulePhoneBook.applyFilter(text);\n\t\t\t}\n\t\t});\n\n\t\t// Initialize DatTable\n\t\tModulePhoneBook.$recordsTable.dataTable({\n\t\t\tsearch: {\n\t\t\t\tsearch: ModulePhoneBook.$globalSearch.val(),\n\t\t\t},\n\t\t\tserverSide: true,\n\t\t\tprocessing: true,\n\t\t\tajax: {\n\t\t\t\turl: ModulePhoneBook.getNewRecordsAJAXUrl,\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataSrc: 'data',\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{ data: null },\n\t\t\t\t{ data: 'call_id' },\n\t\t\t\t{ data: 'number' },\n\t\t\t\t{ data: null },\n\t\t\t],\n\t\t\tpaging: true,\n\t\t\t// scrollY: $(window).height() - ModulePhoneBook.$recordsTable.offset().top-200,\n\t\t\t// stateSave: true,\n\t\t\tsDom: 'rtip',\n\t\t\tdeferRender: true,\n\t\t\tpageLength: 17,\n\n\t\t\t// scrollCollapse: true,\n\t\t\t// scroller: true,\n\t\t\t/**\n\t\t\t * Builder row presentation\n\t\t\t * @param row\n\t\t\t * @param data\n\t\t\t */\n\t\t\tcreatedRow(row, data) {\n\t\t\t\tconst templateName =\n\t\t\t\t\t'<div class=\"ui transparent fluid input inline-edit\">' +\n\t\t\t\t\t`<input class=\"caller-id-input\" type=\"text\" data-value=\"${data.call_id}\" value=\"${data.call_id}\">` +\n\t\t\t\t\t'</div>';\n\n\t\t\t\tconst templateCid =\n\t\t\t\t\t'<div class=\"ui transparent input inline-edit\">' +\n\t\t\t\t\t`<input class=\"number-input\" type=\"text\" data-value=\"${data.number}\" value=\"${data.number}\">` +\n\t\t\t\t\t'</div>';\n\n\t\t\t\tconst templateDeleteButton = '<div class=\"ui small basic icon buttons action-buttons\">' +\n\t\t\t\t\t`<a href=\"${ModulePhoneBook.deleteRecordAJAXUrl}/${data.DT_RowId}\" data-value = \"${data.DT_RowId}\"` +\n\t\t\t\t\t` class=\"ui button delete two-steps-delete popuped\" data-content=\"${globalTranslate.bt_ToolTipDelete}\">` +\n\t\t\t\t\t'<i class=\"icon trash red\"></i></a></div>';\n\n\t\t\t\t$('td', row).eq(0).html('<i class=\"ui user circle icon\"></i>');\n\t\t\t\t$('td', row).eq(1).html(templateName);\n\t\t\t\t$('td', row).eq(2).html(templateCid);\n\t\t\t\t$('td', row).eq(3).html(templateDeleteButton);\n\t\t\t},\n\t\t\t/**\n\t\t\t * Draw event - fired once the table has completed a draw.\n\t\t\t */\n\t\t\tdrawCallback() {\n\t\t\t\tModulePhoneBook.initializeInputmask($(ModulePhoneBook.inputNumberJQTPL));\n\t\t\t},\n\t\t\tlanguage: SemanticLocalization.dataTableLocalisation,\n\t\t\tordering: false,\n\t\t});\n\t\tModulePhoneBook.dataTable = ModulePhoneBook.$recordsTable.DataTable();\n\n\t\tModulePhoneBook.dataTable.on('draw', () => {\n\t\t\tModulePhoneBook.$globalSearch.closest('div').removeClass('loading');\n\t\t});\n\n\t\t// Двойной клик на поле ввода номера\n\t\t$('body').on('focusin', '.caller-id-input, .number-input', (e) => {\n\t\t\tconst currentRowId = $(e.target).closest('tr').attr('id');\n\t\t\t$(e.target).transition('glow');\n\n\t\t\t$(e.target).closest('div')\n\t\t\t\t.removeClass('transparent')\n\t\t\t\t.addClass('changed-field');\n\t\t\t$(e.target).attr('readonly', false);\n\t\t});\n\n\t\t// Отправка формы на сервер по Enter или Tab\n\t\t$(document).on('keydown', (e) => {\n\t\t\tconst keyCode = e.keyCode || e.which;\n\t\t\tif (keyCode === 13\n\t\t\t|| (keyCode === 9 && !$(':focus').hasClass('.number-input'))\n\t\t\t) {\n\t\t\t\tconst $el = $('.changed-field').closest('tr');\n\t\t\t\t$el.each((index, obj) => {\n\t\t\t\t\tconst currentRowId = $(obj).attr('id');\n\t\t\t\t\tif (currentRowId !== undefined) {\n\t\t\t\t\t\tModulePhoneBook.sendChangesToServer(currentRowId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Отправка формы на сервер по уходу с поля ввода\n\t\t$('body').on('focusout', '.caller-id-input, .number-input', () => {\n\t\t\t\tconst $el = $('.changed-field').closest('tr');\n\t\t\t\t$el.each((index, obj) => {\n\t\t\t\t\tconst currentRowId = $(obj).attr('id');\n\t\t\t\t\tif (currentRowId !== undefined) {\n\t\t\t\t\t\tModulePhoneBook.sendChangesToServer(currentRowId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\n\t\t// Клик на кнопку удалить\n\t\t$('body').on('click', 'a.delete', (e) => {\n\t\t\te.preventDefault();\n\t\t\tconst id = $(e.target).closest('a').attr('data-value');\n\t\t\tModulePhoneBook.deleteRow($(e.target), id);\n\t\t});\n\n\t\t// Добавление новой строки\n\t\tModulePhoneBook.$addNewButton.on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\t$('.dataTables_empty').remove();\n\t\t\t// Отправим на запись все что не записано еще\n\t\t\tconst $el = $('.changed-field').closest('tr');\n\t\t\t$el.each((index, obj) => {\n\t\t\t\tconst currentRowId = $(obj).attr('id');\n\t\t\t\tif (currentRowId !== undefined) {\n\t\t\t\t\tModulePhoneBook.sendChangesToServer(currentRowId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst id = `new${Math.floor(Math.random() * Math.floor(500))}`;\n\t\t\tconst rowTemplate = `<tr id=\"${id}\">` +\n\t\t\t\t'<td><i class=\"ui user circle icon\"></i></td>' +\n\t\t\t\t'<td><div class=\"ui fluid input inline-edit changed-field\"><input class=\"caller-id-input\" type=\"text\" data-value=\"\" value=\"\"></div></td>' +\n\t\t\t\t'<td><div class=\"ui fluid input inline-edit changed-field\"><input class=\"number-input\" type=\"text\" data-value=\"\" value=\"\"></div></td>' +\n\t\t\t\t'<td><div class=\"ui small basic icon buttons action-buttons\">' +\n\t\t\t\t\t`<a href=\"#\" class=\"ui button delete two-steps-delete popuped\" data-value = \"new\" data-content=\"${globalTranslate.bt_ToolTipDelete}\">` +\n\t\t\t\t\t'<i class=\"icon trash red\"></i></a></div></td>' +\n\t\t\t\t'</tr>';\n\t\t\tModulePhoneBook.$recordsTable.find('tbody > tr:first').before(rowTemplate);\n\t\t\t$(`tr#${id} input`).transition('glow');\n\t\t\t$(`tr#${id} .caller-id-input`).focus();\n\t\t\tModulePhoneBook.initializeInputmask($(`tr#${id} .number-input`));\n\t\t});\n\t},\n\t/**\n\t * Отправка данных на сервер при измении\n\t */\n\tsendChangesToServer(recordId) {\n\n\t\tconst callerIdInputVal = $(`tr#${recordId} .caller-id-input`).val();\n\t\tconst numberInputVal = $(`tr#${recordId} .number-input`).val();\n\t\tif (!callerIdInputVal || !numberInputVal){\n\t\t\treturn;\n\t\t}\n\t\tlet number = numberInputVal.replace(/\\D+/g, '');\n\t\tnumber=`1${number.substr(number.length - 9)}`;\n\t\tconst data = {\n\t\t\tcall_id: callerIdInputVal,\n\t\t\tnumber_rep: numberInputVal,\n\t\t\tnumber: number,\n\t\t\tid: recordId,\n\t\t};\n\n\t\t// Добавим иконку сохранения\n\t\t$(`tr#${recordId} .user.circle`)\n\t\t\t.removeClass('user circle')\n\t\t\t.addClass('spinner loading');\n\n\t\t$.api({\n\t\t\turl: ModulePhoneBook.saveRecordAJAXUrl,\n\t\t\ton: 'now',\n\t\t\tmethod: 'POST',\n\t\t\tdata,\n\t\t\tsuccessTest(response) {\n\t\t\t\t// test whether a JSON response is valid\n\t\t\t\treturn response !== undefined\n\t\t\t\t\t&& Object.keys(response).length > 0\n\t\t\t\t\t&& response.success === true;\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.data !== undefined) {\n\t\t\t\t\tlet oldId = response.data.oldId;\n\t\t\t\t\tif (oldId===null){\n\t\t\t\t\t\toldId = recordId;\n\t\t\t\t\t}\n\n\t\t\t\t\t$(`tr#${oldId} input`).attr('readonly', true);\n\t\t\t\t\t$(`tr#${oldId} div`).removeClass('changed-field loading').addClass('transparent');\n\t\t\t\t\t//ModulePhoneBook.$addNewButton.removeClass('disabled');\n\t\t\t\t\t$(`tr#${oldId} .spinner.loading`)\n\t\t\t\t\t\t.addClass('user circle')\n\t\t\t\t\t\t.removeClass('spinner loading');\n\t\t\t\t\tif (oldId !== response.data.newId){\n\t\t\t\t\t\t$(`tr#${oldId}`).attr('id', response.data.newId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonFailure(response) {\n\t\t\t\tif (response.message !== undefined) {\n\t\t\t\t\tUserMessage.showMultiString(response.message);\n\t\t\t\t}\n\t\t\t\t$(`tr#${recordId} .spinner.loading`)\n\t\t\t\t\t.addClass('user circle')\n\t\t\t\t\t.removeClass('spinner loading');\n\t\t\t},\n\t\t\tonError(errorMessage, element, xhr) {\n\t\t\t\tif (xhr.status === 403) {\n\t\t\t\t\twindow.location = `${globalRootUrl}session/index`;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t},\n\t/**\n\t * Инициализирует красивое представление номеров\n\t */\n\tinitializeInputmask($el) {\n\t\tif (ModulePhoneBook.$maskList === null) {\n\t\t\t// Подготовим таблицу для сортировки\n\t\t\tModulePhoneBook.$maskList = $.masksSort(InputMaskPatterns, ['#'], /[0-9]|#/, 'mask');\n\t\t}\n\t\t$el.inputmasks({\n\t\t\tinputmask: {\n\t\t\t\tdefinitions: {\n\t\t\t\t\t'#': {\n\t\t\t\t\t\tvalidator: '[0-9]',\n\t\t\t\t\t\tcardinality: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tshowMaskOnHover: false,\n\t\t\t\t// oncleared: extension.cbOnClearedMobileNumber,\n\t\t\t\t// oncomplete: extension.cbOnCompleteMobileNumber,\n\t\t\t\t// clearIncomplete: true,\n\t\t\t\tonBeforePaste: ModulePhoneBook.cbOnNumberBeforePaste,\n\t\t\t\t// regex: /\\D+/,\n\t\t\t},\n\t\t\tmatch: /[0-9]/,\n\t\t\treplace: '9',\n\t\t\tlist: ModulePhoneBook.$maskList,\n\t\t\tlistKey: 'mask',\n\n\t\t});\n\t},\n\t/**\n\t * Изменение статуса кнопок при изменении статуса модуля\n\t */\n\tcheckStatusToggle() {\n\t\tif (ModulePhoneBook.$statusToggle.checkbox('is checked')) {\n\t\t\tModulePhoneBook.$disabilityFields.removeClass('disabled');\n\t\t\tModulePhoneBook.$moduleStatus.show();\n\t\t} else {\n\t\t\tModulePhoneBook.$disabilityFields.addClass('disabled');\n\t\t\tModulePhoneBook.$moduleStatus.hide();\n\t\t}\n\t},\n\t/**\n\t * Server side filter\n\t * @param text\n\t */\n\tapplyFilter(text) {\n\t\tconst $changedFields = $('.changed-field');\n\t\t$changedFields.each((index, obj) => {\n\t\t\t$(obj).removeClass('changed-field').addClass('transparent');\n\t\t\tconst $input = $(obj).find('input');\n\t\t\t$input.val($input.attr('data-value'));\n\t\t\t$input.attr('readonly', true);\n\t\t});\n\t\tModulePhoneBook.dataTable.search(text).draw();\n\t\tModulePhoneBook.$globalSearch.closest('div').addClass('loading');\n\t},\n\t/**\n\t * Очистка номера перед вставкой от лишних символов\n\t * @returns {boolean|*|void|string}\n\t */\n\tcbOnNumberBeforePaste(pastedValue) {\n\t\treturn pastedValue.replace(/\\D+/g, '');\n\t},\n\t/**\n\t * Удаление строки\n\t * @param $target - jquery button target\n\t * @param id - record id\n\t */\n\tdeleteRow($target, id) {\n\t\tif (id === 'new') {\n\t\t\t$target.closest('tr').remove();\n\t\t\treturn;\n\t\t}\n\t\t$.api({\n\t\t\turl: `${globalRootUrl}module-phone-book/delete/${id}`,\n\t\t\ton: 'now',\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\t$target.closest('tr').remove();\n\t\t\t\t\tif (ModulePhoneBook.$recordsTable.find('tbody > tr').length===0){\n\t\t\t\t\t\tModulePhoneBook.$recordsTable.find('tbody').append('<tr class=\"odd\"></tr>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t},\n};\n\n$(document).ready(() => {\n\tModulePhoneBook.initialize();\n});\n"],"file":"module-phonebook-index.js"}