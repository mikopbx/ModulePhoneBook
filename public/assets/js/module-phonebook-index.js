"use strict";

/*
 * Copyright (C) MIKO LLC - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Nikolay Beketov, 11 2018
 *
 */

/* global globalRootUrl,globalTranslate,
SemanticLocalization, UserMessage, InputMaskPatterns */
var ModulePhoneBook = {
  $formObj: $('#module-phonebook-form'),
  $checkBoxes: $('#module-phonebook-form .ui.checkbox'),
  $disabilityFields: $('#module-phonebook-form  .disability'),
  $statusToggle: $('#module-status-toggle'),
  $disableInputMaskToggle: $('#disableInputMask'),
  $moduleStatus: $('#status'),
  $globalSearch: $('#globalsearch'),
  $recordsTable: $('#phonebook-table'),
  $addNewButton: $('#add-new-button'),
  $tabMenu: $('#module-phonebook-menu .item'),
  inputNumberJQTPL: 'input.number-input',
  getNewRecordsAJAXUrl: "".concat(globalRootUrl, "module-phone-book/getNewRecords"),
  deleteRecordAJAXUrl: "".concat(globalRootUrl, "module-phone-book/delete"),
  saveRecordAJAXUrl: "".concat(globalRootUrl, "module-phone-book/save"),
  $maskList: null,
  validateRules: {},
  initialize: function initialize() {
    ModulePhoneBook.$tabMenu.tab();
    ModulePhoneBook.$checkBoxes.checkbox();
    ModulePhoneBook.checkStatusToggle();
    window.addEventListener('ModuleStatusChanged', ModulePhoneBook.checkStatusToggle); // Global Search filter

    ModulePhoneBook.$globalSearch.on('keyup', function (e) {
      if (e.keyCode === 13 || e.keyCode === 8 || ModulePhoneBook.$globalSearch.val().length === 0) {
        var text = "".concat(ModulePhoneBook.$globalSearch.val());
        ModulePhoneBook.applyFilter(text);
      }
    }); // Initialize DatTable

    ModulePhoneBook.$recordsTable.dataTable({
      search: {
        search: ModulePhoneBook.$globalSearch.val()
      },
      serverSide: true,
      processing: true,
      ajax: {
        url: ModulePhoneBook.getNewRecordsAJAXUrl,
        type: 'POST',
        dataSrc: 'data'
      },
      columns: [{
        data: null
      }, {
        data: 'call_id'
      }, {
        data: 'number'
      }, {
        data: null
      }],
      paging: true,
      // scrollY: $(window).height() - ModulePhoneBook.$recordsTable.offset().top-200,
      // stateSave: true,
      sDom: 'rtip',
      deferRender: true,
      pageLength: 17,
      // scrollCollapse: true,
      // scroller: true,

      /**
       * Builder row presentation
       * @param row
       * @param data
       */
      createdRow: function createdRow(row, data) {
        var templateName = '<div class="ui transparent fluid input inline-edit">' + "<input class=\"caller-id-input\" type=\"text\" data-value=\"".concat(data.call_id, "\" value=\"").concat(data.call_id, "\">") + '</div>';
        var templateCid = '<div class="ui transparent input inline-edit">' + "<input class=\"number-input\" type=\"text\" data-value=\"".concat(data.number, "\" value=\"").concat(data.number, "\">") + '</div>';
        var templateDeleteButton = '<div class="ui small basic icon buttons action-buttons">' + "<a href=\"".concat(ModulePhoneBook.deleteRecordAJAXUrl, "/").concat(data.DT_RowId, "\" data-value = \"").concat(data.DT_RowId, "\"") + " class=\"ui button delete two-steps-delete popuped\" data-content=\"".concat(globalTranslate.bt_ToolTipDelete, "\">") + '<i class="icon trash red"></i></a></div>';
        $('td', row).eq(0).html('<i class="ui user circle icon"></i>');
        $('td', row).eq(1).html(templateName);
        $('td', row).eq(2).html(templateCid);
        $('td', row).eq(3).html(templateDeleteButton);
      },

      /**
       * Draw event - fired once the table has completed a draw.
       */
      drawCallback: function drawCallback() {
        ModulePhoneBook.initializeInputmask($(ModulePhoneBook.inputNumberJQTPL));
      },
      language: SemanticLocalization.dataTableLocalisation,
      ordering: false
    });
    ModulePhoneBook.dataTable = ModulePhoneBook.$recordsTable.DataTable();
    ModulePhoneBook.dataTable.on('draw', function () {
      ModulePhoneBook.$globalSearch.closest('div').removeClass('loading');
    }); // Двойной клик на поле ввода номера

    $('body').on('focusin', '.caller-id-input, .number-input', function (e) {
      var currentRowId = $(e.target).closest('tr').attr('id');
      $(e.target).transition('glow');
      $(e.target).closest('div').removeClass('transparent').addClass('changed-field');
      $(e.target).attr('readonly', false);
    }); // Отправка формы на сервер по Enter или Tab

    $(document).on('keydown', function (e) {
      var keyCode = e.keyCode || e.which;

      if (keyCode === 13 || keyCode === 9 && !$(':focus').hasClass('.number-input')) {
        var $el = $('.changed-field').closest('tr');
        $el.each(function (index, obj) {
          var currentRowId = $(obj).attr('id');

          if (currentRowId !== undefined) {
            ModulePhoneBook.sendChangesToServer(currentRowId);
          }
        });
      }
    }); // Отправка формы на сервер по уходу с поля ввода

    $('body').on('focusout', '.caller-id-input, .number-input', function () {
      var $el = $('.changed-field').closest('tr');
      $el.each(function (index, obj) {
        var currentRowId = $(obj).attr('id');

        if (currentRowId !== undefined) {
          ModulePhoneBook.sendChangesToServer(currentRowId);
        }
      });
    }); // Клик на кнопку удалить

    $('body').on('click', 'a.delete', function (e) {
      e.preventDefault();
      var id = $(e.target).closest('a').attr('data-value');
      ModulePhoneBook.deleteRow($(e.target), id);
    }); // Добавление новой строки

    ModulePhoneBook.$addNewButton.on('click', function (e) {
      e.preventDefault();
      $('.dataTables_empty').remove(); // Отправим на запись все что не записано еще

      var $el = $('.changed-field').closest('tr');
      $el.each(function (index, obj) {
        var currentRowId = $(obj).attr('id');

        if (currentRowId !== undefined) {
          ModulePhoneBook.sendChangesToServer(currentRowId);
        }
      });
      var id = "new".concat(Math.floor(Math.random() * Math.floor(500)));
      var rowTemplate = "<tr id=\"".concat(id, "\">") + '<td><i class="ui user circle icon"></i></td>' + '<td><div class="ui fluid input inline-edit changed-field"><input class="caller-id-input" type="text" data-value="" value=""></div></td>' + '<td><div class="ui fluid input inline-edit changed-field"><input class="number-input" type="text" data-value="" value=""></div></td>' + '<td><div class="ui small basic icon buttons action-buttons">' + "<a href=\"#\" class=\"ui button delete two-steps-delete popuped\" data-value = \"new\" data-content=\"".concat(globalTranslate.bt_ToolTipDelete, "\">") + '<i class="icon trash red"></i></a></div></td>' + '</tr>';
      ModulePhoneBook.$recordsTable.find('tbody > tr:first').before(rowTemplate);
      $("tr#".concat(id, " input")).transition('glow');
      $("tr#".concat(id, " .caller-id-input")).focus();
      ModulePhoneBook.initializeInputmask($("tr#".concat(id, " .number-input")));
    });
  },

  /**
   * Отправка данных на сервер при измении
   */
  sendChangesToServer: function sendChangesToServer(recordId) {
    var callerIdInputVal = $("tr#".concat(recordId, " .caller-id-input")).val();
    var numberInputVal = $("tr#".concat(recordId, " .number-input")).val();

    if (!callerIdInputVal || !numberInputVal) {
      return;
    }

    var number = numberInputVal.replace(/\D+/g, '');
    number = "1".concat(number.substr(number.length - 9));
    var data = {
      call_id: callerIdInputVal,
      number_rep: numberInputVal,
      number: number,
      id: recordId
    }; // Добавим иконку сохранения

    $("tr#".concat(recordId, " .user.circle")).removeClass('user circle').addClass('spinner loading');
    $.api({
      url: ModulePhoneBook.saveRecordAJAXUrl,
      on: 'now',
      method: 'POST',
      data: data,
      successTest: function successTest(response) {
        // test whether a JSON response is valid
        return response !== undefined && Object.keys(response).length > 0 && response.success === true;
      },
      onSuccess: function onSuccess(response) {
        if (response.data !== undefined) {
          var oldId = response.data.oldId;

          if (oldId === null) {
            oldId = recordId;
          }

          $("tr#".concat(oldId, " input")).attr('readonly', true);
          $("tr#".concat(oldId, " div")).removeClass('changed-field loading').addClass('transparent'); //ModulePhoneBook.$addNewButton.removeClass('disabled');

          $("tr#".concat(oldId, " .spinner.loading")).addClass('user circle').removeClass('spinner loading');

          if (oldId !== response.data.newId) {
            $("tr#".concat(oldId)).attr('id', response.data.newId);
          }
        }
      },
      onFailure: function onFailure(response) {
        if (response.message !== undefined) {
          UserMessage.showMultiString(response.message);
        }

        $("tr#".concat(recordId, " .spinner.loading")).addClass('user circle').removeClass('spinner loading');
      },
      onError: function onError(errorMessage, element, xhr) {
        if (xhr.status === 403) {
          window.location = "".concat(globalRootUrl, "session/index");
        }
      }
    });
  },

  /**
   * Инициализирует красивое представление номеров
   */
  initializeInputmask: function initializeInputmask($el) {
    if (ModulePhoneBook.$disableInputMaskToggle.checkbox('is checked')) {
      return;
    }

    if (ModulePhoneBook.$maskList === null) {
      // Подготовим таблицу для сортировки
      ModulePhoneBook.$maskList = $.masksSort(InputMaskPatterns, ['#'], /[0-9]|#/, 'mask');
    }

    $el.inputmasks({
      inputmask: {
        definitions: {
          '#': {
            validator: '[0-9]',
            cardinality: 1
          }
        },
        showMaskOnHover: false,
        // oncleared: extension.cbOnClearedMobileNumber,
        // oncomplete: extension.cbOnCompleteMobileNumber,
        // clearIncomplete: true,
        onBeforePaste: ModulePhoneBook.cbOnNumberBeforePaste // regex: /\D+/,

      },
      match: /[0-9]/,
      replace: '9',
      list: ModulePhoneBook.$maskList,
      listKey: 'mask'
    });
  },

  /**
   * Изменение статуса кнопок при изменении статуса модуля
   */
  checkStatusToggle: function checkStatusToggle() {
    if (ModulePhoneBook.$statusToggle.checkbox('is checked')) {
      ModulePhoneBook.$disabilityFields.removeClass('disabled');
      ModulePhoneBook.$moduleStatus.show();
    } else {
      ModulePhoneBook.$disabilityFields.addClass('disabled');
      ModulePhoneBook.$moduleStatus.hide();
    }
  },

  /**
   * Server side filter
   * @param text
   */
  applyFilter: function applyFilter(text) {
    var $changedFields = $('.changed-field');
    $changedFields.each(function (index, obj) {
      $(obj).removeClass('changed-field').addClass('transparent');
      var $input = $(obj).find('input');
      $input.val($input.attr('data-value'));
      $input.attr('readonly', true);
    });
    ModulePhoneBook.dataTable.search(text).draw();
    ModulePhoneBook.$globalSearch.closest('div').addClass('loading');
  },

  /**
   * Очистка номера перед вставкой от лишних символов
   * @returns {boolean|*|void|string}
   */
  cbOnNumberBeforePaste: function cbOnNumberBeforePaste(pastedValue) {
    return pastedValue.replace(/\D+/g, '');
  },

  /**
   * Удаление строки
   * @param $target - jquery button target
   * @param id - record id
   */
  deleteRow: function deleteRow($target, id) {
    if (id === 'new') {
      $target.closest('tr').remove();
      return;
    }

    $.api({
      url: "".concat(globalRootUrl, "module-phone-book/delete/").concat(id),
      on: 'now',
      onSuccess: function onSuccess(response) {
        if (response.success) {
          $target.closest('tr').remove();

          if (ModulePhoneBook.$recordsTable.find('tbody > tr').length === 0) {
            ModulePhoneBook.$recordsTable.find('tbody').append('<tr class="odd"></tr>');
          }
        }
      }
    });
  }
};
$(document).ready(function () {
  ModulePhoneBook.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUtcGhvbmVib29rLWluZGV4LmpzIl0sIm5hbWVzIjpbIk1vZHVsZVBob25lQm9vayIsIiRmb3JtT2JqIiwiJCIsIiRjaGVja0JveGVzIiwiJGRpc2FiaWxpdHlGaWVsZHMiLCIkc3RhdHVzVG9nZ2xlIiwiJGRpc2FibGVJbnB1dE1hc2tUb2dnbGUiLCIkbW9kdWxlU3RhdHVzIiwiJGdsb2JhbFNlYXJjaCIsIiRyZWNvcmRzVGFibGUiLCIkYWRkTmV3QnV0dG9uIiwiJHRhYk1lbnUiLCJpbnB1dE51bWJlckpRVFBMIiwiZ2V0TmV3UmVjb3Jkc0FKQVhVcmwiLCJnbG9iYWxSb290VXJsIiwiZGVsZXRlUmVjb3JkQUpBWFVybCIsInNhdmVSZWNvcmRBSkFYVXJsIiwiJG1hc2tMaXN0IiwidmFsaWRhdGVSdWxlcyIsImluaXRpYWxpemUiLCJ0YWIiLCJjaGVja2JveCIsImNoZWNrU3RhdHVzVG9nZ2xlIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uIiwiZSIsImtleUNvZGUiLCJ2YWwiLCJsZW5ndGgiLCJ0ZXh0IiwiYXBwbHlGaWx0ZXIiLCJkYXRhVGFibGUiLCJzZWFyY2giLCJzZXJ2ZXJTaWRlIiwicHJvY2Vzc2luZyIsImFqYXgiLCJ1cmwiLCJ0eXBlIiwiZGF0YVNyYyIsImNvbHVtbnMiLCJkYXRhIiwicGFnaW5nIiwic0RvbSIsImRlZmVyUmVuZGVyIiwicGFnZUxlbmd0aCIsImNyZWF0ZWRSb3ciLCJyb3ciLCJ0ZW1wbGF0ZU5hbWUiLCJjYWxsX2lkIiwidGVtcGxhdGVDaWQiLCJudW1iZXIiLCJ0ZW1wbGF0ZURlbGV0ZUJ1dHRvbiIsIkRUX1Jvd0lkIiwiZ2xvYmFsVHJhbnNsYXRlIiwiYnRfVG9vbFRpcERlbGV0ZSIsImVxIiwiaHRtbCIsImRyYXdDYWxsYmFjayIsImluaXRpYWxpemVJbnB1dG1hc2siLCJsYW5ndWFnZSIsIlNlbWFudGljTG9jYWxpemF0aW9uIiwiZGF0YVRhYmxlTG9jYWxpc2F0aW9uIiwib3JkZXJpbmciLCJEYXRhVGFibGUiLCJjbG9zZXN0IiwicmVtb3ZlQ2xhc3MiLCJjdXJyZW50Um93SWQiLCJ0YXJnZXQiLCJhdHRyIiwidHJhbnNpdGlvbiIsImFkZENsYXNzIiwiZG9jdW1lbnQiLCJ3aGljaCIsImhhc0NsYXNzIiwiJGVsIiwiZWFjaCIsImluZGV4Iiwib2JqIiwidW5kZWZpbmVkIiwic2VuZENoYW5nZXNUb1NlcnZlciIsInByZXZlbnREZWZhdWx0IiwiaWQiLCJkZWxldGVSb3ciLCJyZW1vdmUiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyb3dUZW1wbGF0ZSIsImZpbmQiLCJiZWZvcmUiLCJmb2N1cyIsInJlY29yZElkIiwiY2FsbGVySWRJbnB1dFZhbCIsIm51bWJlcklucHV0VmFsIiwicmVwbGFjZSIsInN1YnN0ciIsIm51bWJlcl9yZXAiLCJhcGkiLCJtZXRob2QiLCJzdWNjZXNzVGVzdCIsInJlc3BvbnNlIiwiT2JqZWN0Iiwia2V5cyIsInN1Y2Nlc3MiLCJvblN1Y2Nlc3MiLCJvbGRJZCIsIm5ld0lkIiwib25GYWlsdXJlIiwibWVzc2FnZSIsIlVzZXJNZXNzYWdlIiwic2hvd011bHRpU3RyaW5nIiwib25FcnJvciIsImVycm9yTWVzc2FnZSIsImVsZW1lbnQiLCJ4aHIiLCJzdGF0dXMiLCJsb2NhdGlvbiIsIm1hc2tzU29ydCIsIklucHV0TWFza1BhdHRlcm5zIiwiaW5wdXRtYXNrcyIsImlucHV0bWFzayIsImRlZmluaXRpb25zIiwidmFsaWRhdG9yIiwiY2FyZGluYWxpdHkiLCJzaG93TWFza09uSG92ZXIiLCJvbkJlZm9yZVBhc3RlIiwiY2JPbk51bWJlckJlZm9yZVBhc3RlIiwibWF0Y2giLCJsaXN0IiwibGlzdEtleSIsInNob3ciLCJoaWRlIiwiJGNoYW5nZWRGaWVsZHMiLCIkaW5wdXQiLCJkcmF3IiwicGFzdGVkVmFsdWUiLCIkdGFyZ2V0IiwiYXBwZW5kIiwicmVhZHkiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBLElBQU1BLGVBQWUsR0FBRztBQUN2QkMsRUFBQUEsUUFBUSxFQUFFQyxDQUFDLENBQUMsd0JBQUQsQ0FEWTtBQUV2QkMsRUFBQUEsV0FBVyxFQUFFRCxDQUFDLENBQUMscUNBQUQsQ0FGUztBQUd2QkUsRUFBQUEsaUJBQWlCLEVBQUVGLENBQUMsQ0FBQyxxQ0FBRCxDQUhHO0FBSXZCRyxFQUFBQSxhQUFhLEVBQUVILENBQUMsQ0FBQyx1QkFBRCxDQUpPO0FBS3ZCSSxFQUFBQSx1QkFBdUIsRUFBRUosQ0FBQyxDQUFDLG1CQUFELENBTEg7QUFNdkJLLEVBQUFBLGFBQWEsRUFBRUwsQ0FBQyxDQUFDLFNBQUQsQ0FOTztBQU92Qk0sRUFBQUEsYUFBYSxFQUFFTixDQUFDLENBQUMsZUFBRCxDQVBPO0FBUXZCTyxFQUFBQSxhQUFhLEVBQUVQLENBQUMsQ0FBQyxrQkFBRCxDQVJPO0FBU3ZCUSxFQUFBQSxhQUFhLEVBQUVSLENBQUMsQ0FBQyxpQkFBRCxDQVRPO0FBVXZCUyxFQUFBQSxRQUFRLEVBQUVULENBQUMsQ0FBQyw4QkFBRCxDQVZZO0FBV3ZCVSxFQUFBQSxnQkFBZ0IsRUFBRSxvQkFYSztBQVl2QkMsRUFBQUEsb0JBQW9CLFlBQUtDLGFBQUwsb0NBWkc7QUFhdkJDLEVBQUFBLG1CQUFtQixZQUFLRCxhQUFMLDZCQWJJO0FBY3ZCRSxFQUFBQSxpQkFBaUIsWUFBS0YsYUFBTCwyQkFkTTtBQWV2QkcsRUFBQUEsU0FBUyxFQUFFLElBZlk7QUFnQnZCQyxFQUFBQSxhQUFhLEVBQUUsRUFoQlE7QUFrQnZCQyxFQUFBQSxVQWxCdUIsd0JBa0JWO0FBQ1puQixJQUFBQSxlQUFlLENBQUNXLFFBQWhCLENBQXlCUyxHQUF6QjtBQUVBcEIsSUFBQUEsZUFBZSxDQUFDRyxXQUFoQixDQUE0QmtCLFFBQTVCO0FBRUFyQixJQUFBQSxlQUFlLENBQUNzQixpQkFBaEI7QUFDQUMsSUFBQUEsTUFBTSxDQUFDQyxnQkFBUCxDQUF3QixxQkFBeEIsRUFBK0N4QixlQUFlLENBQUNzQixpQkFBL0QsRUFOWSxDQVFaOztBQUNBdEIsSUFBQUEsZUFBZSxDQUFDUSxhQUFoQixDQUE4QmlCLEVBQTlCLENBQWlDLE9BQWpDLEVBQTBDLFVBQUNDLENBQUQsRUFBTztBQUNoRCxVQUFJQSxDQUFDLENBQUNDLE9BQUYsS0FBYyxFQUFkLElBQ0FELENBQUMsQ0FBQ0MsT0FBRixLQUFjLENBRGQsSUFFQTNCLGVBQWUsQ0FBQ1EsYUFBaEIsQ0FBOEJvQixHQUE5QixHQUFvQ0MsTUFBcEMsS0FBK0MsQ0FGbkQsRUFFc0Q7QUFDckQsWUFBTUMsSUFBSSxhQUFNOUIsZUFBZSxDQUFDUSxhQUFoQixDQUE4Qm9CLEdBQTlCLEVBQU4sQ0FBVjtBQUNBNUIsUUFBQUEsZUFBZSxDQUFDK0IsV0FBaEIsQ0FBNEJELElBQTVCO0FBQ0E7QUFDRCxLQVBELEVBVFksQ0FrQlo7O0FBQ0E5QixJQUFBQSxlQUFlLENBQUNTLGFBQWhCLENBQThCdUIsU0FBOUIsQ0FBd0M7QUFDdkNDLE1BQUFBLE1BQU0sRUFBRTtBQUNQQSxRQUFBQSxNQUFNLEVBQUVqQyxlQUFlLENBQUNRLGFBQWhCLENBQThCb0IsR0FBOUI7QUFERCxPQUQrQjtBQUl2Q00sTUFBQUEsVUFBVSxFQUFFLElBSjJCO0FBS3ZDQyxNQUFBQSxVQUFVLEVBQUUsSUFMMkI7QUFNdkNDLE1BQUFBLElBQUksRUFBRTtBQUNMQyxRQUFBQSxHQUFHLEVBQUVyQyxlQUFlLENBQUNhLG9CQURoQjtBQUVMeUIsUUFBQUEsSUFBSSxFQUFFLE1BRkQ7QUFHTEMsUUFBQUEsT0FBTyxFQUFFO0FBSEosT0FOaUM7QUFXdkNDLE1BQUFBLE9BQU8sRUFBRSxDQUNSO0FBQUVDLFFBQUFBLElBQUksRUFBRTtBQUFSLE9BRFEsRUFFUjtBQUFFQSxRQUFBQSxJQUFJLEVBQUU7QUFBUixPQUZRLEVBR1I7QUFBRUEsUUFBQUEsSUFBSSxFQUFFO0FBQVIsT0FIUSxFQUlSO0FBQUVBLFFBQUFBLElBQUksRUFBRTtBQUFSLE9BSlEsQ0FYOEI7QUFpQnZDQyxNQUFBQSxNQUFNLEVBQUUsSUFqQitCO0FBa0J2QztBQUNBO0FBQ0FDLE1BQUFBLElBQUksRUFBRSxNQXBCaUM7QUFxQnZDQyxNQUFBQSxXQUFXLEVBQUUsSUFyQjBCO0FBc0J2Q0MsTUFBQUEsVUFBVSxFQUFFLEVBdEIyQjtBQXdCdkM7QUFDQTs7QUFDQTtBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0dDLE1BQUFBLFVBL0J1QyxzQkErQjVCQyxHQS9CNEIsRUErQnZCTixJQS9CdUIsRUErQmpCO0FBQ3JCLFlBQU1PLFlBQVksR0FDakIsK0hBQzBEUCxJQUFJLENBQUNRLE9BRC9ELHdCQUNrRlIsSUFBSSxDQUFDUSxPQUR2RixXQUVBLFFBSEQ7QUFLQSxZQUFNQyxXQUFXLEdBQ2hCLHNIQUN1RFQsSUFBSSxDQUFDVSxNQUQ1RCx3QkFDOEVWLElBQUksQ0FBQ1UsTUFEbkYsV0FFQSxRQUhEO0FBS0EsWUFBTUMsb0JBQW9CLEdBQUcsaUZBQ2hCcEQsZUFBZSxDQUFDZSxtQkFEQSxjQUN1QjBCLElBQUksQ0FBQ1ksUUFENUIsK0JBQ3VEWixJQUFJLENBQUNZLFFBRDVELHdGQUV3Q0MsZUFBZSxDQUFDQyxnQkFGeEQsV0FHNUIsMENBSEQ7QUFLQXJELFFBQUFBLENBQUMsQ0FBQyxJQUFELEVBQU82QyxHQUFQLENBQUQsQ0FBYVMsRUFBYixDQUFnQixDQUFoQixFQUFtQkMsSUFBbkIsQ0FBd0IscUNBQXhCO0FBQ0F2RCxRQUFBQSxDQUFDLENBQUMsSUFBRCxFQUFPNkMsR0FBUCxDQUFELENBQWFTLEVBQWIsQ0FBZ0IsQ0FBaEIsRUFBbUJDLElBQW5CLENBQXdCVCxZQUF4QjtBQUNBOUMsUUFBQUEsQ0FBQyxDQUFDLElBQUQsRUFBTzZDLEdBQVAsQ0FBRCxDQUFhUyxFQUFiLENBQWdCLENBQWhCLEVBQW1CQyxJQUFuQixDQUF3QlAsV0FBeEI7QUFDQWhELFFBQUFBLENBQUMsQ0FBQyxJQUFELEVBQU82QyxHQUFQLENBQUQsQ0FBYVMsRUFBYixDQUFnQixDQUFoQixFQUFtQkMsSUFBbkIsQ0FBd0JMLG9CQUF4QjtBQUNBLE9BbkRzQzs7QUFvRHZDO0FBQ0g7QUFDQTtBQUNHTSxNQUFBQSxZQXZEdUMsMEJBdUR4QjtBQUNkMUQsUUFBQUEsZUFBZSxDQUFDMkQsbUJBQWhCLENBQW9DekQsQ0FBQyxDQUFDRixlQUFlLENBQUNZLGdCQUFqQixDQUFyQztBQUNBLE9BekRzQztBQTBEdkNnRCxNQUFBQSxRQUFRLEVBQUVDLG9CQUFvQixDQUFDQyxxQkExRFE7QUEyRHZDQyxNQUFBQSxRQUFRLEVBQUU7QUEzRDZCLEtBQXhDO0FBNkRBL0QsSUFBQUEsZUFBZSxDQUFDZ0MsU0FBaEIsR0FBNEJoQyxlQUFlLENBQUNTLGFBQWhCLENBQThCdUQsU0FBOUIsRUFBNUI7QUFFQWhFLElBQUFBLGVBQWUsQ0FBQ2dDLFNBQWhCLENBQTBCUCxFQUExQixDQUE2QixNQUE3QixFQUFxQyxZQUFNO0FBQzFDekIsTUFBQUEsZUFBZSxDQUFDUSxhQUFoQixDQUE4QnlELE9BQTlCLENBQXNDLEtBQXRDLEVBQTZDQyxXQUE3QyxDQUF5RCxTQUF6RDtBQUNBLEtBRkQsRUFsRlksQ0FzRlo7O0FBQ0FoRSxJQUFBQSxDQUFDLENBQUMsTUFBRCxDQUFELENBQVV1QixFQUFWLENBQWEsU0FBYixFQUF3QixpQ0FBeEIsRUFBMkQsVUFBQ0MsQ0FBRCxFQUFPO0FBQ2pFLFVBQU15QyxZQUFZLEdBQUdqRSxDQUFDLENBQUN3QixDQUFDLENBQUMwQyxNQUFILENBQUQsQ0FBWUgsT0FBWixDQUFvQixJQUFwQixFQUEwQkksSUFBMUIsQ0FBK0IsSUFBL0IsQ0FBckI7QUFDQW5FLE1BQUFBLENBQUMsQ0FBQ3dCLENBQUMsQ0FBQzBDLE1BQUgsQ0FBRCxDQUFZRSxVQUFaLENBQXVCLE1BQXZCO0FBRUFwRSxNQUFBQSxDQUFDLENBQUN3QixDQUFDLENBQUMwQyxNQUFILENBQUQsQ0FBWUgsT0FBWixDQUFvQixLQUFwQixFQUNFQyxXQURGLENBQ2MsYUFEZCxFQUVFSyxRQUZGLENBRVcsZUFGWDtBQUdBckUsTUFBQUEsQ0FBQyxDQUFDd0IsQ0FBQyxDQUFDMEMsTUFBSCxDQUFELENBQVlDLElBQVosQ0FBaUIsVUFBakIsRUFBNkIsS0FBN0I7QUFDQSxLQVJELEVBdkZZLENBaUdaOztBQUNBbkUsSUFBQUEsQ0FBQyxDQUFDc0UsUUFBRCxDQUFELENBQVkvQyxFQUFaLENBQWUsU0FBZixFQUEwQixVQUFDQyxDQUFELEVBQU87QUFDaEMsVUFBTUMsT0FBTyxHQUFHRCxDQUFDLENBQUNDLE9BQUYsSUFBYUQsQ0FBQyxDQUFDK0MsS0FBL0I7O0FBQ0EsVUFBSTlDLE9BQU8sS0FBSyxFQUFaLElBQ0FBLE9BQU8sS0FBSyxDQUFaLElBQWlCLENBQUN6QixDQUFDLENBQUMsUUFBRCxDQUFELENBQVl3RSxRQUFaLENBQXFCLGVBQXJCLENBRHRCLEVBRUU7QUFDRCxZQUFNQyxHQUFHLEdBQUd6RSxDQUFDLENBQUMsZ0JBQUQsQ0FBRCxDQUFvQitELE9BQXBCLENBQTRCLElBQTVCLENBQVo7QUFDQVUsUUFBQUEsR0FBRyxDQUFDQyxJQUFKLENBQVMsVUFBQ0MsS0FBRCxFQUFRQyxHQUFSLEVBQWdCO0FBQ3hCLGNBQU1YLFlBQVksR0FBR2pFLENBQUMsQ0FBQzRFLEdBQUQsQ0FBRCxDQUFPVCxJQUFQLENBQVksSUFBWixDQUFyQjs7QUFDQSxjQUFJRixZQUFZLEtBQUtZLFNBQXJCLEVBQWdDO0FBQy9CL0UsWUFBQUEsZUFBZSxDQUFDZ0YsbUJBQWhCLENBQW9DYixZQUFwQztBQUNBO0FBQ0QsU0FMRDtBQU1BO0FBQ0QsS0FiRCxFQWxHWSxDQWlIWjs7QUFDQWpFLElBQUFBLENBQUMsQ0FBQyxNQUFELENBQUQsQ0FBVXVCLEVBQVYsQ0FBYSxVQUFiLEVBQXlCLGlDQUF6QixFQUE0RCxZQUFNO0FBQ2hFLFVBQU1rRCxHQUFHLEdBQUd6RSxDQUFDLENBQUMsZ0JBQUQsQ0FBRCxDQUFvQitELE9BQXBCLENBQTRCLElBQTVCLENBQVo7QUFDQVUsTUFBQUEsR0FBRyxDQUFDQyxJQUFKLENBQVMsVUFBQ0MsS0FBRCxFQUFRQyxHQUFSLEVBQWdCO0FBQ3hCLFlBQU1YLFlBQVksR0FBR2pFLENBQUMsQ0FBQzRFLEdBQUQsQ0FBRCxDQUFPVCxJQUFQLENBQVksSUFBWixDQUFyQjs7QUFDQSxZQUFJRixZQUFZLEtBQUtZLFNBQXJCLEVBQWdDO0FBQy9CL0UsVUFBQUEsZUFBZSxDQUFDZ0YsbUJBQWhCLENBQW9DYixZQUFwQztBQUNBO0FBQ0QsT0FMRDtBQU1ELEtBUkQsRUFsSFksQ0E0SFo7O0FBQ0FqRSxJQUFBQSxDQUFDLENBQUMsTUFBRCxDQUFELENBQVV1QixFQUFWLENBQWEsT0FBYixFQUFzQixVQUF0QixFQUFrQyxVQUFDQyxDQUFELEVBQU87QUFDeENBLE1BQUFBLENBQUMsQ0FBQ3VELGNBQUY7QUFDQSxVQUFNQyxFQUFFLEdBQUdoRixDQUFDLENBQUN3QixDQUFDLENBQUMwQyxNQUFILENBQUQsQ0FBWUgsT0FBWixDQUFvQixHQUFwQixFQUF5QkksSUFBekIsQ0FBOEIsWUFBOUIsQ0FBWDtBQUNBckUsTUFBQUEsZUFBZSxDQUFDbUYsU0FBaEIsQ0FBMEJqRixDQUFDLENBQUN3QixDQUFDLENBQUMwQyxNQUFILENBQTNCLEVBQXVDYyxFQUF2QztBQUNBLEtBSkQsRUE3SFksQ0FtSVo7O0FBQ0FsRixJQUFBQSxlQUFlLENBQUNVLGFBQWhCLENBQThCZSxFQUE5QixDQUFpQyxPQUFqQyxFQUEwQyxVQUFDQyxDQUFELEVBQU87QUFDaERBLE1BQUFBLENBQUMsQ0FBQ3VELGNBQUY7QUFDQS9FLE1BQUFBLENBQUMsQ0FBQyxtQkFBRCxDQUFELENBQXVCa0YsTUFBdkIsR0FGZ0QsQ0FHaEQ7O0FBQ0EsVUFBTVQsR0FBRyxHQUFHekUsQ0FBQyxDQUFDLGdCQUFELENBQUQsQ0FBb0IrRCxPQUFwQixDQUE0QixJQUE1QixDQUFaO0FBQ0FVLE1BQUFBLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLFVBQUNDLEtBQUQsRUFBUUMsR0FBUixFQUFnQjtBQUN4QixZQUFNWCxZQUFZLEdBQUdqRSxDQUFDLENBQUM0RSxHQUFELENBQUQsQ0FBT1QsSUFBUCxDQUFZLElBQVosQ0FBckI7O0FBQ0EsWUFBSUYsWUFBWSxLQUFLWSxTQUFyQixFQUFnQztBQUMvQi9FLFVBQUFBLGVBQWUsQ0FBQ2dGLG1CQUFoQixDQUFvQ2IsWUFBcEM7QUFDQTtBQUNELE9BTEQ7QUFPQSxVQUFNZSxFQUFFLGdCQUFTRyxJQUFJLENBQUNDLEtBQUwsQ0FBV0QsSUFBSSxDQUFDRSxNQUFMLEtBQWdCRixJQUFJLENBQUNDLEtBQUwsQ0FBVyxHQUFYLENBQTNCLENBQVQsQ0FBUjtBQUNBLFVBQU1FLFdBQVcsR0FBRyxtQkFBV04sRUFBWCxXQUNuQiw4Q0FEbUIsR0FFbkIseUlBRm1CLEdBR25CLHNJQUhtQixHQUluQiw4REFKbUIsbUhBS2dGNUIsZUFBZSxDQUFDQyxnQkFMaEcsV0FNbEIsK0NBTmtCLEdBT25CLE9BUEQ7QUFRQXZELE1BQUFBLGVBQWUsQ0FBQ1MsYUFBaEIsQ0FBOEJnRixJQUE5QixDQUFtQyxrQkFBbkMsRUFBdURDLE1BQXZELENBQThERixXQUE5RDtBQUNBdEYsTUFBQUEsQ0FBQyxjQUFPZ0YsRUFBUCxZQUFELENBQW9CWixVQUFwQixDQUErQixNQUEvQjtBQUNBcEUsTUFBQUEsQ0FBQyxjQUFPZ0YsRUFBUCx1QkFBRCxDQUErQlMsS0FBL0I7QUFDQTNGLE1BQUFBLGVBQWUsQ0FBQzJELG1CQUFoQixDQUFvQ3pELENBQUMsY0FBT2dGLEVBQVAsb0JBQXJDO0FBQ0EsS0F6QkQ7QUEwQkEsR0FoTHNCOztBQWlMdkI7QUFDRDtBQUNBO0FBQ0NGLEVBQUFBLG1CQXBMdUIsK0JBb0xIWSxRQXBMRyxFQW9MTztBQUU3QixRQUFNQyxnQkFBZ0IsR0FBRzNGLENBQUMsY0FBTzBGLFFBQVAsdUJBQUQsQ0FBcUNoRSxHQUFyQyxFQUF6QjtBQUNBLFFBQU1rRSxjQUFjLEdBQUc1RixDQUFDLGNBQU8wRixRQUFQLG9CQUFELENBQWtDaEUsR0FBbEMsRUFBdkI7O0FBQ0EsUUFBSSxDQUFDaUUsZ0JBQUQsSUFBcUIsQ0FBQ0MsY0FBMUIsRUFBeUM7QUFDeEM7QUFDQTs7QUFDRCxRQUFJM0MsTUFBTSxHQUFHMkMsY0FBYyxDQUFDQyxPQUFmLENBQXVCLE1BQXZCLEVBQStCLEVBQS9CLENBQWI7QUFDQTVDLElBQUFBLE1BQU0sY0FBS0EsTUFBTSxDQUFDNkMsTUFBUCxDQUFjN0MsTUFBTSxDQUFDdEIsTUFBUCxHQUFnQixDQUE5QixDQUFMLENBQU47QUFDQSxRQUFNWSxJQUFJLEdBQUc7QUFDWlEsTUFBQUEsT0FBTyxFQUFFNEMsZ0JBREc7QUFFWkksTUFBQUEsVUFBVSxFQUFFSCxjQUZBO0FBR1ozQyxNQUFBQSxNQUFNLEVBQUVBLE1BSEk7QUFJWitCLE1BQUFBLEVBQUUsRUFBRVU7QUFKUSxLQUFiLENBVDZCLENBZ0I3Qjs7QUFDQTFGLElBQUFBLENBQUMsY0FBTzBGLFFBQVAsbUJBQUQsQ0FDRTFCLFdBREYsQ0FDYyxhQURkLEVBRUVLLFFBRkYsQ0FFVyxpQkFGWDtBQUlBckUsSUFBQUEsQ0FBQyxDQUFDZ0csR0FBRixDQUFNO0FBQ0w3RCxNQUFBQSxHQUFHLEVBQUVyQyxlQUFlLENBQUNnQixpQkFEaEI7QUFFTFMsTUFBQUEsRUFBRSxFQUFFLEtBRkM7QUFHTDBFLE1BQUFBLE1BQU0sRUFBRSxNQUhIO0FBSUwxRCxNQUFBQSxJQUFJLEVBQUpBLElBSks7QUFLTDJELE1BQUFBLFdBTEssdUJBS09DLFFBTFAsRUFLaUI7QUFDckI7QUFDQSxlQUFPQSxRQUFRLEtBQUt0QixTQUFiLElBQ0h1QixNQUFNLENBQUNDLElBQVAsQ0FBWUYsUUFBWixFQUFzQnhFLE1BQXRCLEdBQStCLENBRDVCLElBRUh3RSxRQUFRLENBQUNHLE9BQVQsS0FBcUIsSUFGekI7QUFHQSxPQVZJO0FBV0xDLE1BQUFBLFNBWEsscUJBV0tKLFFBWEwsRUFXZTtBQUNuQixZQUFJQSxRQUFRLENBQUM1RCxJQUFULEtBQWtCc0MsU0FBdEIsRUFBaUM7QUFDaEMsY0FBSTJCLEtBQUssR0FBR0wsUUFBUSxDQUFDNUQsSUFBVCxDQUFjaUUsS0FBMUI7O0FBQ0EsY0FBSUEsS0FBSyxLQUFHLElBQVosRUFBaUI7QUFDaEJBLFlBQUFBLEtBQUssR0FBR2QsUUFBUjtBQUNBOztBQUVEMUYsVUFBQUEsQ0FBQyxjQUFPd0csS0FBUCxZQUFELENBQXVCckMsSUFBdkIsQ0FBNEIsVUFBNUIsRUFBd0MsSUFBeEM7QUFDQW5FLFVBQUFBLENBQUMsY0FBT3dHLEtBQVAsVUFBRCxDQUFxQnhDLFdBQXJCLENBQWlDLHVCQUFqQyxFQUEwREssUUFBMUQsQ0FBbUUsYUFBbkUsRUFQZ0MsQ0FRaEM7O0FBQ0FyRSxVQUFBQSxDQUFDLGNBQU93RyxLQUFQLHVCQUFELENBQ0VuQyxRQURGLENBQ1csYUFEWCxFQUVFTCxXQUZGLENBRWMsaUJBRmQ7O0FBR0EsY0FBSXdDLEtBQUssS0FBS0wsUUFBUSxDQUFDNUQsSUFBVCxDQUFja0UsS0FBNUIsRUFBa0M7QUFDakN6RyxZQUFBQSxDQUFDLGNBQU93RyxLQUFQLEVBQUQsQ0FBaUJyQyxJQUFqQixDQUFzQixJQUF0QixFQUE0QmdDLFFBQVEsQ0FBQzVELElBQVQsQ0FBY2tFLEtBQTFDO0FBQ0E7QUFDRDtBQUNELE9BNUJJO0FBNkJMQyxNQUFBQSxTQTdCSyxxQkE2QktQLFFBN0JMLEVBNkJlO0FBQ25CLFlBQUlBLFFBQVEsQ0FBQ1EsT0FBVCxLQUFxQjlCLFNBQXpCLEVBQW9DO0FBQ25DK0IsVUFBQUEsV0FBVyxDQUFDQyxlQUFaLENBQTRCVixRQUFRLENBQUNRLE9BQXJDO0FBQ0E7O0FBQ0QzRyxRQUFBQSxDQUFDLGNBQU8wRixRQUFQLHVCQUFELENBQ0VyQixRQURGLENBQ1csYUFEWCxFQUVFTCxXQUZGLENBRWMsaUJBRmQ7QUFHQSxPQXBDSTtBQXFDTDhDLE1BQUFBLE9BckNLLG1CQXFDR0MsWUFyQ0gsRUFxQ2lCQyxPQXJDakIsRUFxQzBCQyxHQXJDMUIsRUFxQytCO0FBQ25DLFlBQUlBLEdBQUcsQ0FBQ0MsTUFBSixLQUFlLEdBQW5CLEVBQXdCO0FBQ3ZCN0YsVUFBQUEsTUFBTSxDQUFDOEYsUUFBUCxhQUFxQnZHLGFBQXJCO0FBQ0E7QUFDRDtBQXpDSSxLQUFOO0FBMkNBLEdBcFBzQjs7QUFxUHZCO0FBQ0Q7QUFDQTtBQUNDNkMsRUFBQUEsbUJBeFB1QiwrQkF3UEhnQixHQXhQRyxFQXdQRTtBQUN4QixRQUFJM0UsZUFBZSxDQUFDTSx1QkFBaEIsQ0FBd0NlLFFBQXhDLENBQWlELFlBQWpELENBQUosRUFBbUU7QUFDbEU7QUFDQTs7QUFDRCxRQUFJckIsZUFBZSxDQUFDaUIsU0FBaEIsS0FBOEIsSUFBbEMsRUFBd0M7QUFDdkM7QUFDQWpCLE1BQUFBLGVBQWUsQ0FBQ2lCLFNBQWhCLEdBQTRCZixDQUFDLENBQUNvSCxTQUFGLENBQVlDLGlCQUFaLEVBQStCLENBQUMsR0FBRCxDQUEvQixFQUFzQyxTQUF0QyxFQUFpRCxNQUFqRCxDQUE1QjtBQUNBOztBQUNENUMsSUFBQUEsR0FBRyxDQUFDNkMsVUFBSixDQUFlO0FBQ2RDLE1BQUFBLFNBQVMsRUFBRTtBQUNWQyxRQUFBQSxXQUFXLEVBQUU7QUFDWixlQUFLO0FBQ0pDLFlBQUFBLFNBQVMsRUFBRSxPQURQO0FBRUpDLFlBQUFBLFdBQVcsRUFBRTtBQUZUO0FBRE8sU0FESDtBQU9WQyxRQUFBQSxlQUFlLEVBQUUsS0FQUDtBQVFWO0FBQ0E7QUFDQTtBQUNBQyxRQUFBQSxhQUFhLEVBQUU5SCxlQUFlLENBQUMrSCxxQkFYckIsQ0FZVjs7QUFaVSxPQURHO0FBZWRDLE1BQUFBLEtBQUssRUFBRSxPQWZPO0FBZ0JkakMsTUFBQUEsT0FBTyxFQUFFLEdBaEJLO0FBaUJka0MsTUFBQUEsSUFBSSxFQUFFakksZUFBZSxDQUFDaUIsU0FqQlI7QUFrQmRpSCxNQUFBQSxPQUFPLEVBQUU7QUFsQkssS0FBZjtBQXFCQSxHQXJSc0I7O0FBc1J2QjtBQUNEO0FBQ0E7QUFDQzVHLEVBQUFBLGlCQXpSdUIsK0JBeVJIO0FBQ25CLFFBQUl0QixlQUFlLENBQUNLLGFBQWhCLENBQThCZ0IsUUFBOUIsQ0FBdUMsWUFBdkMsQ0FBSixFQUEwRDtBQUN6RHJCLE1BQUFBLGVBQWUsQ0FBQ0ksaUJBQWhCLENBQWtDOEQsV0FBbEMsQ0FBOEMsVUFBOUM7QUFDQWxFLE1BQUFBLGVBQWUsQ0FBQ08sYUFBaEIsQ0FBOEI0SCxJQUE5QjtBQUNBLEtBSEQsTUFHTztBQUNObkksTUFBQUEsZUFBZSxDQUFDSSxpQkFBaEIsQ0FBa0NtRSxRQUFsQyxDQUEyQyxVQUEzQztBQUNBdkUsTUFBQUEsZUFBZSxDQUFDTyxhQUFoQixDQUE4QjZILElBQTlCO0FBQ0E7QUFDRCxHQWpTc0I7O0FBa1N2QjtBQUNEO0FBQ0E7QUFDQTtBQUNDckcsRUFBQUEsV0F0U3VCLHVCQXNTWEQsSUF0U1csRUFzU0w7QUFDakIsUUFBTXVHLGNBQWMsR0FBR25JLENBQUMsQ0FBQyxnQkFBRCxDQUF4QjtBQUNBbUksSUFBQUEsY0FBYyxDQUFDekQsSUFBZixDQUFvQixVQUFDQyxLQUFELEVBQVFDLEdBQVIsRUFBZ0I7QUFDbkM1RSxNQUFBQSxDQUFDLENBQUM0RSxHQUFELENBQUQsQ0FBT1osV0FBUCxDQUFtQixlQUFuQixFQUFvQ0ssUUFBcEMsQ0FBNkMsYUFBN0M7QUFDQSxVQUFNK0QsTUFBTSxHQUFHcEksQ0FBQyxDQUFDNEUsR0FBRCxDQUFELENBQU9XLElBQVAsQ0FBWSxPQUFaLENBQWY7QUFDQTZDLE1BQUFBLE1BQU0sQ0FBQzFHLEdBQVAsQ0FBVzBHLE1BQU0sQ0FBQ2pFLElBQVAsQ0FBWSxZQUFaLENBQVg7QUFDQWlFLE1BQUFBLE1BQU0sQ0FBQ2pFLElBQVAsQ0FBWSxVQUFaLEVBQXdCLElBQXhCO0FBQ0EsS0FMRDtBQU1BckUsSUFBQUEsZUFBZSxDQUFDZ0MsU0FBaEIsQ0FBMEJDLE1BQTFCLENBQWlDSCxJQUFqQyxFQUF1Q3lHLElBQXZDO0FBQ0F2SSxJQUFBQSxlQUFlLENBQUNRLGFBQWhCLENBQThCeUQsT0FBOUIsQ0FBc0MsS0FBdEMsRUFBNkNNLFFBQTdDLENBQXNELFNBQXREO0FBQ0EsR0FoVHNCOztBQWlUdkI7QUFDRDtBQUNBO0FBQ0E7QUFDQ3dELEVBQUFBLHFCQXJUdUIsaUNBcVREUyxXQXJUQyxFQXFUWTtBQUNsQyxXQUFPQSxXQUFXLENBQUN6QyxPQUFaLENBQW9CLE1BQXBCLEVBQTRCLEVBQTVCLENBQVA7QUFDQSxHQXZUc0I7O0FBd1R2QjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0NaLEVBQUFBLFNBN1R1QixxQkE2VGJzRCxPQTdUYSxFQTZUSnZELEVBN1RJLEVBNlRBO0FBQ3RCLFFBQUlBLEVBQUUsS0FBSyxLQUFYLEVBQWtCO0FBQ2pCdUQsTUFBQUEsT0FBTyxDQUFDeEUsT0FBUixDQUFnQixJQUFoQixFQUFzQm1CLE1BQXRCO0FBQ0E7QUFDQTs7QUFDRGxGLElBQUFBLENBQUMsQ0FBQ2dHLEdBQUYsQ0FBTTtBQUNMN0QsTUFBQUEsR0FBRyxZQUFLdkIsYUFBTCxzQ0FBOENvRSxFQUE5QyxDQURFO0FBRUx6RCxNQUFBQSxFQUFFLEVBQUUsS0FGQztBQUdMZ0YsTUFBQUEsU0FISyxxQkFHS0osUUFITCxFQUdlO0FBQ25CLFlBQUlBLFFBQVEsQ0FBQ0csT0FBYixFQUFzQjtBQUNyQmlDLFVBQUFBLE9BQU8sQ0FBQ3hFLE9BQVIsQ0FBZ0IsSUFBaEIsRUFBc0JtQixNQUF0Qjs7QUFDQSxjQUFJcEYsZUFBZSxDQUFDUyxhQUFoQixDQUE4QmdGLElBQTlCLENBQW1DLFlBQW5DLEVBQWlENUQsTUFBakQsS0FBMEQsQ0FBOUQsRUFBZ0U7QUFDL0Q3QixZQUFBQSxlQUFlLENBQUNTLGFBQWhCLENBQThCZ0YsSUFBOUIsQ0FBbUMsT0FBbkMsRUFBNENpRCxNQUE1QyxDQUFtRCx1QkFBbkQ7QUFDQTtBQUNEO0FBQ0Q7QUFWSSxLQUFOO0FBWUE7QUE5VXNCLENBQXhCO0FBaVZBeEksQ0FBQyxDQUFDc0UsUUFBRCxDQUFELENBQVltRSxLQUFaLENBQWtCLFlBQU07QUFDdkIzSSxFQUFBQSxlQUFlLENBQUNtQixVQUFoQjtBQUNBLENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChDKSBNSUtPIExMQyAtIEFsbCBSaWdodHMgUmVzZXJ2ZWRcbiAqIFVuYXV0aG9yaXplZCBjb3B5aW5nIG9mIHRoaXMgZmlsZSwgdmlhIGFueSBtZWRpdW0gaXMgc3RyaWN0bHkgcHJvaGliaXRlZFxuICogUHJvcHJpZXRhcnkgYW5kIGNvbmZpZGVudGlhbFxuICogV3JpdHRlbiBieSBOaWtvbGF5IEJla2V0b3YsIDExIDIwMThcbiAqXG4gKi9cblxuLyogZ2xvYmFsIGdsb2JhbFJvb3RVcmwsZ2xvYmFsVHJhbnNsYXRlLFxuU2VtYW50aWNMb2NhbGl6YXRpb24sIFVzZXJNZXNzYWdlLCBJbnB1dE1hc2tQYXR0ZXJucyAqLyBcblxuY29uc3QgTW9kdWxlUGhvbmVCb29rID0ge1xuXHQkZm9ybU9iajogJCgnI21vZHVsZS1waG9uZWJvb2stZm9ybScpLFxuXHQkY2hlY2tCb3hlczogJCgnI21vZHVsZS1waG9uZWJvb2stZm9ybSAudWkuY2hlY2tib3gnKSxcblx0JGRpc2FiaWxpdHlGaWVsZHM6ICQoJyNtb2R1bGUtcGhvbmVib29rLWZvcm0gIC5kaXNhYmlsaXR5JyksXG5cdCRzdGF0dXNUb2dnbGU6ICQoJyNtb2R1bGUtc3RhdHVzLXRvZ2dsZScpLFxuXHQkZGlzYWJsZUlucHV0TWFza1RvZ2dsZTogJCgnI2Rpc2FibGVJbnB1dE1hc2snKSxcblx0JG1vZHVsZVN0YXR1czogJCgnI3N0YXR1cycpLFxuXHQkZ2xvYmFsU2VhcmNoOiAkKCcjZ2xvYmFsc2VhcmNoJyksXG5cdCRyZWNvcmRzVGFibGU6ICQoJyNwaG9uZWJvb2stdGFibGUnKSxcblx0JGFkZE5ld0J1dHRvbjogJCgnI2FkZC1uZXctYnV0dG9uJyksXG5cdCR0YWJNZW51OiAkKCcjbW9kdWxlLXBob25lYm9vay1tZW51IC5pdGVtJyksXG5cdGlucHV0TnVtYmVySlFUUEw6ICdpbnB1dC5udW1iZXItaW5wdXQnLFxuXHRnZXROZXdSZWNvcmRzQUpBWFVybDogYCR7Z2xvYmFsUm9vdFVybH1tb2R1bGUtcGhvbmUtYm9vay9nZXROZXdSZWNvcmRzYCxcblx0ZGVsZXRlUmVjb3JkQUpBWFVybDogYCR7Z2xvYmFsUm9vdFVybH1tb2R1bGUtcGhvbmUtYm9vay9kZWxldGVgLFxuXHRzYXZlUmVjb3JkQUpBWFVybDogYCR7Z2xvYmFsUm9vdFVybH1tb2R1bGUtcGhvbmUtYm9vay9zYXZlYCxcblx0JG1hc2tMaXN0OiBudWxsLFxuXHR2YWxpZGF0ZVJ1bGVzOiB7XG5cdH0sXG5cdGluaXRpYWxpemUoKSB7XG5cdFx0TW9kdWxlUGhvbmVCb29rLiR0YWJNZW51LnRhYigpO1xuXG5cdFx0TW9kdWxlUGhvbmVCb29rLiRjaGVja0JveGVzLmNoZWNrYm94KCk7XG5cblx0XHRNb2R1bGVQaG9uZUJvb2suY2hlY2tTdGF0dXNUb2dnbGUoKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignTW9kdWxlU3RhdHVzQ2hhbmdlZCcsIE1vZHVsZVBob25lQm9vay5jaGVja1N0YXR1c1RvZ2dsZSk7XG5cblx0XHQvLyBHbG9iYWwgU2VhcmNoIGZpbHRlclxuXHRcdE1vZHVsZVBob25lQm9vay4kZ2xvYmFsU2VhcmNoLm9uKCdrZXl1cCcsIChlKSA9PiB7XG5cdFx0XHRpZiAoZS5rZXlDb2RlID09PSAxM1xuXHRcdFx0XHR8fCBlLmtleUNvZGUgPT09IDhcblx0XHRcdFx0fHwgTW9kdWxlUGhvbmVCb29rLiRnbG9iYWxTZWFyY2gudmFsKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdGNvbnN0IHRleHQgPSBgJHtNb2R1bGVQaG9uZUJvb2suJGdsb2JhbFNlYXJjaC52YWwoKX1gO1xuXHRcdFx0XHRNb2R1bGVQaG9uZUJvb2suYXBwbHlGaWx0ZXIodGV4dCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBJbml0aWFsaXplIERhdFRhYmxlXG5cdFx0TW9kdWxlUGhvbmVCb29rLiRyZWNvcmRzVGFibGUuZGF0YVRhYmxlKHtcblx0XHRcdHNlYXJjaDoge1xuXHRcdFx0XHRzZWFyY2g6IE1vZHVsZVBob25lQm9vay4kZ2xvYmFsU2VhcmNoLnZhbCgpLFxuXHRcdFx0fSxcblx0XHRcdHNlcnZlclNpZGU6IHRydWUsXG5cdFx0XHRwcm9jZXNzaW5nOiB0cnVlLFxuXHRcdFx0YWpheDoge1xuXHRcdFx0XHR1cmw6IE1vZHVsZVBob25lQm9vay5nZXROZXdSZWNvcmRzQUpBWFVybCxcblx0XHRcdFx0dHlwZTogJ1BPU1QnLFxuXHRcdFx0XHRkYXRhU3JjOiAnZGF0YScsXG5cdFx0XHR9LFxuXHRcdFx0Y29sdW1uczogW1xuXHRcdFx0XHR7IGRhdGE6IG51bGwgfSxcblx0XHRcdFx0eyBkYXRhOiAnY2FsbF9pZCcgfSxcblx0XHRcdFx0eyBkYXRhOiAnbnVtYmVyJyB9LFxuXHRcdFx0XHR7IGRhdGE6IG51bGwgfSxcblx0XHRcdF0sXG5cdFx0XHRwYWdpbmc6IHRydWUsXG5cdFx0XHQvLyBzY3JvbGxZOiAkKHdpbmRvdykuaGVpZ2h0KCkgLSBNb2R1bGVQaG9uZUJvb2suJHJlY29yZHNUYWJsZS5vZmZzZXQoKS50b3AtMjAwLFxuXHRcdFx0Ly8gc3RhdGVTYXZlOiB0cnVlLFxuXHRcdFx0c0RvbTogJ3J0aXAnLFxuXHRcdFx0ZGVmZXJSZW5kZXI6IHRydWUsXG5cdFx0XHRwYWdlTGVuZ3RoOiAxNyxcblxuXHRcdFx0Ly8gc2Nyb2xsQ29sbGFwc2U6IHRydWUsXG5cdFx0XHQvLyBzY3JvbGxlcjogdHJ1ZSxcblx0XHRcdC8qKlxuXHRcdFx0ICogQnVpbGRlciByb3cgcHJlc2VudGF0aW9uXG5cdFx0XHQgKiBAcGFyYW0gcm93XG5cdFx0XHQgKiBAcGFyYW0gZGF0YVxuXHRcdFx0ICovXG5cdFx0XHRjcmVhdGVkUm93KHJvdywgZGF0YSkge1xuXHRcdFx0XHRjb25zdCB0ZW1wbGF0ZU5hbWUgPVxuXHRcdFx0XHRcdCc8ZGl2IGNsYXNzPVwidWkgdHJhbnNwYXJlbnQgZmx1aWQgaW5wdXQgaW5saW5lLWVkaXRcIj4nICtcblx0XHRcdFx0XHRgPGlucHV0IGNsYXNzPVwiY2FsbGVyLWlkLWlucHV0XCIgdHlwZT1cInRleHRcIiBkYXRhLXZhbHVlPVwiJHtkYXRhLmNhbGxfaWR9XCIgdmFsdWU9XCIke2RhdGEuY2FsbF9pZH1cIj5gICtcblx0XHRcdFx0XHQnPC9kaXY+JztcblxuXHRcdFx0XHRjb25zdCB0ZW1wbGF0ZUNpZCA9XG5cdFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJ1aSB0cmFuc3BhcmVudCBpbnB1dCBpbmxpbmUtZWRpdFwiPicgK1xuXHRcdFx0XHRcdGA8aW5wdXQgY2xhc3M9XCJudW1iZXItaW5wdXRcIiB0eXBlPVwidGV4dFwiIGRhdGEtdmFsdWU9XCIke2RhdGEubnVtYmVyfVwiIHZhbHVlPVwiJHtkYXRhLm51bWJlcn1cIj5gICtcblx0XHRcdFx0XHQnPC9kaXY+JztcblxuXHRcdFx0XHRjb25zdCB0ZW1wbGF0ZURlbGV0ZUJ1dHRvbiA9ICc8ZGl2IGNsYXNzPVwidWkgc21hbGwgYmFzaWMgaWNvbiBidXR0b25zIGFjdGlvbi1idXR0b25zXCI+JyArXG5cdFx0XHRcdFx0YDxhIGhyZWY9XCIke01vZHVsZVBob25lQm9vay5kZWxldGVSZWNvcmRBSkFYVXJsfS8ke2RhdGEuRFRfUm93SWR9XCIgZGF0YS12YWx1ZSA9IFwiJHtkYXRhLkRUX1Jvd0lkfVwiYCArXG5cdFx0XHRcdFx0YCBjbGFzcz1cInVpIGJ1dHRvbiBkZWxldGUgdHdvLXN0ZXBzLWRlbGV0ZSBwb3B1cGVkXCIgZGF0YS1jb250ZW50PVwiJHtnbG9iYWxUcmFuc2xhdGUuYnRfVG9vbFRpcERlbGV0ZX1cIj5gICtcblx0XHRcdFx0XHQnPGkgY2xhc3M9XCJpY29uIHRyYXNoIHJlZFwiPjwvaT48L2E+PC9kaXY+JztcblxuXHRcdFx0XHQkKCd0ZCcsIHJvdykuZXEoMCkuaHRtbCgnPGkgY2xhc3M9XCJ1aSB1c2VyIGNpcmNsZSBpY29uXCI+PC9pPicpO1xuXHRcdFx0XHQkKCd0ZCcsIHJvdykuZXEoMSkuaHRtbCh0ZW1wbGF0ZU5hbWUpO1xuXHRcdFx0XHQkKCd0ZCcsIHJvdykuZXEoMikuaHRtbCh0ZW1wbGF0ZUNpZCk7XG5cdFx0XHRcdCQoJ3RkJywgcm93KS5lcSgzKS5odG1sKHRlbXBsYXRlRGVsZXRlQnV0dG9uKTtcblx0XHRcdH0sXG5cdFx0XHQvKipcblx0XHRcdCAqIERyYXcgZXZlbnQgLSBmaXJlZCBvbmNlIHRoZSB0YWJsZSBoYXMgY29tcGxldGVkIGEgZHJhdy5cblx0XHRcdCAqL1xuXHRcdFx0ZHJhd0NhbGxiYWNrKCkge1xuXHRcdFx0XHRNb2R1bGVQaG9uZUJvb2suaW5pdGlhbGl6ZUlucHV0bWFzaygkKE1vZHVsZVBob25lQm9vay5pbnB1dE51bWJlckpRVFBMKSk7XG5cdFx0XHR9LFxuXHRcdFx0bGFuZ3VhZ2U6IFNlbWFudGljTG9jYWxpemF0aW9uLmRhdGFUYWJsZUxvY2FsaXNhdGlvbixcblx0XHRcdG9yZGVyaW5nOiBmYWxzZSxcblx0XHR9KTtcblx0XHRNb2R1bGVQaG9uZUJvb2suZGF0YVRhYmxlID0gTW9kdWxlUGhvbmVCb29rLiRyZWNvcmRzVGFibGUuRGF0YVRhYmxlKCk7XG5cblx0XHRNb2R1bGVQaG9uZUJvb2suZGF0YVRhYmxlLm9uKCdkcmF3JywgKCkgPT4ge1xuXHRcdFx0TW9kdWxlUGhvbmVCb29rLiRnbG9iYWxTZWFyY2guY2xvc2VzdCgnZGl2JykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcblx0XHR9KTtcblxuXHRcdC8vINCU0LLQvtC50L3QvtC5INC60LvQuNC6INC90LAg0L/QvtC70LUg0LLQstC+0LTQsCDQvdC+0LzQtdGA0LBcblx0XHQkKCdib2R5Jykub24oJ2ZvY3VzaW4nLCAnLmNhbGxlci1pZC1pbnB1dCwgLm51bWJlci1pbnB1dCcsIChlKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50Um93SWQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCd0cicpLmF0dHIoJ2lkJyk7XG5cdFx0XHQkKGUudGFyZ2V0KS50cmFuc2l0aW9uKCdnbG93Jyk7XG5cblx0XHRcdCQoZS50YXJnZXQpLmNsb3Nlc3QoJ2RpdicpXG5cdFx0XHRcdC5yZW1vdmVDbGFzcygndHJhbnNwYXJlbnQnKVxuXHRcdFx0XHQuYWRkQ2xhc3MoJ2NoYW5nZWQtZmllbGQnKTtcblx0XHRcdCQoZS50YXJnZXQpLmF0dHIoJ3JlYWRvbmx5JywgZmFsc2UpO1xuXHRcdH0pO1xuXG5cdFx0Ly8g0J7RgtC/0YDQsNCy0LrQsCDRhNC+0YDQvNGLINC90LAg0YHQtdGA0LLQtdGAINC/0L4gRW50ZXIg0LjQu9C4IFRhYlxuXHRcdCQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgKGUpID0+IHtcblx0XHRcdGNvbnN0IGtleUNvZGUgPSBlLmtleUNvZGUgfHwgZS53aGljaDtcblx0XHRcdGlmIChrZXlDb2RlID09PSAxM1xuXHRcdFx0fHwgKGtleUNvZGUgPT09IDkgJiYgISQoJzpmb2N1cycpLmhhc0NsYXNzKCcubnVtYmVyLWlucHV0JykpXG5cdFx0XHQpIHtcblx0XHRcdFx0Y29uc3QgJGVsID0gJCgnLmNoYW5nZWQtZmllbGQnKS5jbG9zZXN0KCd0cicpO1xuXHRcdFx0XHQkZWwuZWFjaCgoaW5kZXgsIG9iaikgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRSb3dJZCA9ICQob2JqKS5hdHRyKCdpZCcpO1xuXHRcdFx0XHRcdGlmIChjdXJyZW50Um93SWQgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0TW9kdWxlUGhvbmVCb29rLnNlbmRDaGFuZ2VzVG9TZXJ2ZXIoY3VycmVudFJvd0lkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8g0J7RgtC/0YDQsNCy0LrQsCDRhNC+0YDQvNGLINC90LAg0YHQtdGA0LLQtdGAINC/0L4g0YPRhdC+0LTRgyDRgSDQv9C+0LvRjyDQstCy0L7QtNCwXG5cdFx0JCgnYm9keScpLm9uKCdmb2N1c291dCcsICcuY2FsbGVyLWlkLWlucHV0LCAubnVtYmVyLWlucHV0JywgKCkgPT4ge1xuXHRcdFx0XHRjb25zdCAkZWwgPSAkKCcuY2hhbmdlZC1maWVsZCcpLmNsb3Nlc3QoJ3RyJyk7XG5cdFx0XHRcdCRlbC5lYWNoKChpbmRleCwgb2JqKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudFJvd0lkID0gJChvYmopLmF0dHIoJ2lkJyk7XG5cdFx0XHRcdFx0aWYgKGN1cnJlbnRSb3dJZCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRNb2R1bGVQaG9uZUJvb2suc2VuZENoYW5nZXNUb1NlcnZlcihjdXJyZW50Um93SWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyDQmtC70LjQuiDQvdCwINC60L3QvtC/0LrRgyDRg9C00LDQu9C40YLRjFxuXHRcdCQoJ2JvZHknKS5vbignY2xpY2snLCAnYS5kZWxldGUnLCAoZSkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Y29uc3QgaWQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCdhJykuYXR0cignZGF0YS12YWx1ZScpO1xuXHRcdFx0TW9kdWxlUGhvbmVCb29rLmRlbGV0ZVJvdygkKGUudGFyZ2V0KSwgaWQpO1xuXHRcdH0pO1xuXG5cdFx0Ly8g0JTQvtCx0LDQstC70LXQvdC40LUg0L3QvtCy0L7QuSDRgdGC0YDQvtC60Lhcblx0XHRNb2R1bGVQaG9uZUJvb2suJGFkZE5ld0J1dHRvbi5vbignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0JCgnLmRhdGFUYWJsZXNfZW1wdHknKS5yZW1vdmUoKTtcblx0XHRcdC8vINCe0YLQv9GA0LDQstC40Lwg0L3QsCDQt9Cw0L/QuNGB0Ywg0LLRgdC1INGH0YLQviDQvdC1INC30LDQv9C40YHQsNC90L4g0LXRidC1XG5cdFx0XHRjb25zdCAkZWwgPSAkKCcuY2hhbmdlZC1maWVsZCcpLmNsb3Nlc3QoJ3RyJyk7XG5cdFx0XHQkZWwuZWFjaCgoaW5kZXgsIG9iaikgPT4ge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50Um93SWQgPSAkKG9iaikuYXR0cignaWQnKTtcblx0XHRcdFx0aWYgKGN1cnJlbnRSb3dJZCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0TW9kdWxlUGhvbmVCb29rLnNlbmRDaGFuZ2VzVG9TZXJ2ZXIoY3VycmVudFJvd0lkKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IGlkID0gYG5ldyR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogTWF0aC5mbG9vcig1MDApKX1gO1xuXHRcdFx0Y29uc3Qgcm93VGVtcGxhdGUgPSBgPHRyIGlkPVwiJHtpZH1cIj5gICtcblx0XHRcdFx0Jzx0ZD48aSBjbGFzcz1cInVpIHVzZXIgY2lyY2xlIGljb25cIj48L2k+PC90ZD4nICtcblx0XHRcdFx0Jzx0ZD48ZGl2IGNsYXNzPVwidWkgZmx1aWQgaW5wdXQgaW5saW5lLWVkaXQgY2hhbmdlZC1maWVsZFwiPjxpbnB1dCBjbGFzcz1cImNhbGxlci1pZC1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgZGF0YS12YWx1ZT1cIlwiIHZhbHVlPVwiXCI+PC9kaXY+PC90ZD4nICtcblx0XHRcdFx0Jzx0ZD48ZGl2IGNsYXNzPVwidWkgZmx1aWQgaW5wdXQgaW5saW5lLWVkaXQgY2hhbmdlZC1maWVsZFwiPjxpbnB1dCBjbGFzcz1cIm51bWJlci1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgZGF0YS12YWx1ZT1cIlwiIHZhbHVlPVwiXCI+PC9kaXY+PC90ZD4nICtcblx0XHRcdFx0Jzx0ZD48ZGl2IGNsYXNzPVwidWkgc21hbGwgYmFzaWMgaWNvbiBidXR0b25zIGFjdGlvbi1idXR0b25zXCI+JyArXG5cdFx0XHRcdFx0YDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJ1aSBidXR0b24gZGVsZXRlIHR3by1zdGVwcy1kZWxldGUgcG9wdXBlZFwiIGRhdGEtdmFsdWUgPSBcIm5ld1wiIGRhdGEtY29udGVudD1cIiR7Z2xvYmFsVHJhbnNsYXRlLmJ0X1Rvb2xUaXBEZWxldGV9XCI+YCArXG5cdFx0XHRcdFx0JzxpIGNsYXNzPVwiaWNvbiB0cmFzaCByZWRcIj48L2k+PC9hPjwvZGl2PjwvdGQ+JyArXG5cdFx0XHRcdCc8L3RyPic7XG5cdFx0XHRNb2R1bGVQaG9uZUJvb2suJHJlY29yZHNUYWJsZS5maW5kKCd0Ym9keSA+IHRyOmZpcnN0JykuYmVmb3JlKHJvd1RlbXBsYXRlKTtcblx0XHRcdCQoYHRyIyR7aWR9IGlucHV0YCkudHJhbnNpdGlvbignZ2xvdycpO1xuXHRcdFx0JChgdHIjJHtpZH0gLmNhbGxlci1pZC1pbnB1dGApLmZvY3VzKCk7XG5cdFx0XHRNb2R1bGVQaG9uZUJvb2suaW5pdGlhbGl6ZUlucHV0bWFzaygkKGB0ciMke2lkfSAubnVtYmVyLWlucHV0YCkpO1xuXHRcdH0pO1xuXHR9LFxuXHQvKipcblx0ICog0J7RgtC/0YDQsNCy0LrQsCDQtNCw0L3QvdGL0YUg0L3QsCDRgdC10YDQstC10YAg0L/RgNC4INC40LfQvNC10L3QuNC4XG5cdCAqL1xuXHRzZW5kQ2hhbmdlc1RvU2VydmVyKHJlY29yZElkKSB7XG5cblx0XHRjb25zdCBjYWxsZXJJZElucHV0VmFsID0gJChgdHIjJHtyZWNvcmRJZH0gLmNhbGxlci1pZC1pbnB1dGApLnZhbCgpO1xuXHRcdGNvbnN0IG51bWJlcklucHV0VmFsID0gJChgdHIjJHtyZWNvcmRJZH0gLm51bWJlci1pbnB1dGApLnZhbCgpO1xuXHRcdGlmICghY2FsbGVySWRJbnB1dFZhbCB8fCAhbnVtYmVySW5wdXRWYWwpe1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRsZXQgbnVtYmVyID0gbnVtYmVySW5wdXRWYWwucmVwbGFjZSgvXFxEKy9nLCAnJyk7XG5cdFx0bnVtYmVyPWAxJHtudW1iZXIuc3Vic3RyKG51bWJlci5sZW5ndGggLSA5KX1gO1xuXHRcdGNvbnN0IGRhdGEgPSB7XG5cdFx0XHRjYWxsX2lkOiBjYWxsZXJJZElucHV0VmFsLFxuXHRcdFx0bnVtYmVyX3JlcDogbnVtYmVySW5wdXRWYWwsXG5cdFx0XHRudW1iZXI6IG51bWJlcixcblx0XHRcdGlkOiByZWNvcmRJZCxcblx0XHR9O1xuXG5cdFx0Ly8g0JTQvtCx0LDQstC40Lwg0LjQutC+0L3QutGDINGB0L7RhdGA0LDQvdC10L3QuNGPXG5cdFx0JChgdHIjJHtyZWNvcmRJZH0gLnVzZXIuY2lyY2xlYClcblx0XHRcdC5yZW1vdmVDbGFzcygndXNlciBjaXJjbGUnKVxuXHRcdFx0LmFkZENsYXNzKCdzcGlubmVyIGxvYWRpbmcnKTtcblxuXHRcdCQuYXBpKHtcblx0XHRcdHVybDogTW9kdWxlUGhvbmVCb29rLnNhdmVSZWNvcmRBSkFYVXJsLFxuXHRcdFx0b246ICdub3cnLFxuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRkYXRhLFxuXHRcdFx0c3VjY2Vzc1Rlc3QocmVzcG9uc2UpIHtcblx0XHRcdFx0Ly8gdGVzdCB3aGV0aGVyIGEgSlNPTiByZXNwb25zZSBpcyB2YWxpZFxuXHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UgIT09IHVuZGVmaW5lZFxuXHRcdFx0XHRcdCYmIE9iamVjdC5rZXlzKHJlc3BvbnNlKS5sZW5ndGggPiAwXG5cdFx0XHRcdFx0JiYgcmVzcG9uc2Uuc3VjY2VzcyA9PT0gdHJ1ZTtcblx0XHRcdH0sXG5cdFx0XHRvblN1Y2Nlc3MocmVzcG9uc2UpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlLmRhdGEgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdGxldCBvbGRJZCA9IHJlc3BvbnNlLmRhdGEub2xkSWQ7XG5cdFx0XHRcdFx0aWYgKG9sZElkPT09bnVsbCl7XG5cdFx0XHRcdFx0XHRvbGRJZCA9IHJlY29yZElkO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdCQoYHRyIyR7b2xkSWR9IGlucHV0YCkuYXR0cigncmVhZG9ubHknLCB0cnVlKTtcblx0XHRcdFx0XHQkKGB0ciMke29sZElkfSBkaXZgKS5yZW1vdmVDbGFzcygnY2hhbmdlZC1maWVsZCBsb2FkaW5nJykuYWRkQ2xhc3MoJ3RyYW5zcGFyZW50Jyk7XG5cdFx0XHRcdFx0Ly9Nb2R1bGVQaG9uZUJvb2suJGFkZE5ld0J1dHRvbi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdFx0XHQkKGB0ciMke29sZElkfSAuc3Bpbm5lci5sb2FkaW5nYClcblx0XHRcdFx0XHRcdC5hZGRDbGFzcygndXNlciBjaXJjbGUnKVxuXHRcdFx0XHRcdFx0LnJlbW92ZUNsYXNzKCdzcGlubmVyIGxvYWRpbmcnKTtcblx0XHRcdFx0XHRpZiAob2xkSWQgIT09IHJlc3BvbnNlLmRhdGEubmV3SWQpe1xuXHRcdFx0XHRcdFx0JChgdHIjJHtvbGRJZH1gKS5hdHRyKCdpZCcsIHJlc3BvbnNlLmRhdGEubmV3SWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdG9uRmFpbHVyZShyZXNwb25zZSkge1xuXHRcdFx0XHRpZiAocmVzcG9uc2UubWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0VXNlck1lc3NhZ2Uuc2hvd011bHRpU3RyaW5nKHJlc3BvbnNlLm1lc3NhZ2UpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCQoYHRyIyR7cmVjb3JkSWR9IC5zcGlubmVyLmxvYWRpbmdgKVxuXHRcdFx0XHRcdC5hZGRDbGFzcygndXNlciBjaXJjbGUnKVxuXHRcdFx0XHRcdC5yZW1vdmVDbGFzcygnc3Bpbm5lciBsb2FkaW5nJyk7XG5cdFx0XHR9LFxuXHRcdFx0b25FcnJvcihlcnJvck1lc3NhZ2UsIGVsZW1lbnQsIHhocikge1xuXHRcdFx0XHRpZiAoeGhyLnN0YXR1cyA9PT0gNDAzKSB7XG5cdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uID0gYCR7Z2xvYmFsUm9vdFVybH1zZXNzaW9uL2luZGV4YDtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHR9KTtcblx0fSxcblx0LyoqXG5cdCAqINCY0L3QuNGG0LjQsNC70LjQt9C40YDRg9C10YIg0LrRgNCw0YHQuNCy0L7QtSDQv9GA0LXQtNGB0YLQsNCy0LvQtdC90LjQtSDQvdC+0LzQtdGA0L7QslxuXHQgKi9cblx0aW5pdGlhbGl6ZUlucHV0bWFzaygkZWwpIHtcblx0XHRpZiAoTW9kdWxlUGhvbmVCb29rLiRkaXNhYmxlSW5wdXRNYXNrVG9nZ2xlLmNoZWNrYm94KCdpcyBjaGVja2VkJykpe1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoTW9kdWxlUGhvbmVCb29rLiRtYXNrTGlzdCA9PT0gbnVsbCkge1xuXHRcdFx0Ly8g0J/QvtC00LPQvtGC0L7QstC40Lwg0YLQsNCx0LvQuNGG0YMg0LTQu9GPINGB0L7RgNGC0LjRgNC+0LLQutC4XG5cdFx0XHRNb2R1bGVQaG9uZUJvb2suJG1hc2tMaXN0ID0gJC5tYXNrc1NvcnQoSW5wdXRNYXNrUGF0dGVybnMsIFsnIyddLCAvWzAtOV18Iy8sICdtYXNrJyk7XG5cdFx0fVxuXHRcdCRlbC5pbnB1dG1hc2tzKHtcblx0XHRcdGlucHV0bWFzazoge1xuXHRcdFx0XHRkZWZpbml0aW9uczoge1xuXHRcdFx0XHRcdCcjJzoge1xuXHRcdFx0XHRcdFx0dmFsaWRhdG9yOiAnWzAtOV0nLFxuXHRcdFx0XHRcdFx0Y2FyZGluYWxpdHk6IDEsXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0fSxcblx0XHRcdFx0c2hvd01hc2tPbkhvdmVyOiBmYWxzZSxcblx0XHRcdFx0Ly8gb25jbGVhcmVkOiBleHRlbnNpb24uY2JPbkNsZWFyZWRNb2JpbGVOdW1iZXIsXG5cdFx0XHRcdC8vIG9uY29tcGxldGU6IGV4dGVuc2lvbi5jYk9uQ29tcGxldGVNb2JpbGVOdW1iZXIsXG5cdFx0XHRcdC8vIGNsZWFySW5jb21wbGV0ZTogdHJ1ZSxcblx0XHRcdFx0b25CZWZvcmVQYXN0ZTogTW9kdWxlUGhvbmVCb29rLmNiT25OdW1iZXJCZWZvcmVQYXN0ZSxcblx0XHRcdFx0Ly8gcmVnZXg6IC9cXEQrLyxcblx0XHRcdH0sXG5cdFx0XHRtYXRjaDogL1swLTldLyxcblx0XHRcdHJlcGxhY2U6ICc5Jyxcblx0XHRcdGxpc3Q6IE1vZHVsZVBob25lQm9vay4kbWFza0xpc3QsXG5cdFx0XHRsaXN0S2V5OiAnbWFzaycsXG5cblx0XHR9KTtcblx0fSxcblx0LyoqXG5cdCAqINCY0LfQvNC10L3QtdC90LjQtSDRgdGC0LDRgtGD0YHQsCDQutC90L7Qv9C+0Log0L/RgNC4INC40LfQvNC10L3QtdC90LjQuCDRgdGC0LDRgtGD0YHQsCDQvNC+0LTRg9C70Y9cblx0ICovXG5cdGNoZWNrU3RhdHVzVG9nZ2xlKCkge1xuXHRcdGlmIChNb2R1bGVQaG9uZUJvb2suJHN0YXR1c1RvZ2dsZS5jaGVja2JveCgnaXMgY2hlY2tlZCcpKSB7XG5cdFx0XHRNb2R1bGVQaG9uZUJvb2suJGRpc2FiaWxpdHlGaWVsZHMucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cdFx0XHRNb2R1bGVQaG9uZUJvb2suJG1vZHVsZVN0YXR1cy5zaG93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdE1vZHVsZVBob25lQm9vay4kZGlzYWJpbGl0eUZpZWxkcy5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdE1vZHVsZVBob25lQm9vay4kbW9kdWxlU3RhdHVzLmhpZGUoKTtcblx0XHR9XG5cdH0sXG5cdC8qKlxuXHQgKiBTZXJ2ZXIgc2lkZSBmaWx0ZXJcblx0ICogQHBhcmFtIHRleHRcblx0ICovXG5cdGFwcGx5RmlsdGVyKHRleHQpIHtcblx0XHRjb25zdCAkY2hhbmdlZEZpZWxkcyA9ICQoJy5jaGFuZ2VkLWZpZWxkJyk7XG5cdFx0JGNoYW5nZWRGaWVsZHMuZWFjaCgoaW5kZXgsIG9iaikgPT4ge1xuXHRcdFx0JChvYmopLnJlbW92ZUNsYXNzKCdjaGFuZ2VkLWZpZWxkJykuYWRkQ2xhc3MoJ3RyYW5zcGFyZW50Jyk7XG5cdFx0XHRjb25zdCAkaW5wdXQgPSAkKG9iaikuZmluZCgnaW5wdXQnKTtcblx0XHRcdCRpbnB1dC52YWwoJGlucHV0LmF0dHIoJ2RhdGEtdmFsdWUnKSk7XG5cdFx0XHQkaW5wdXQuYXR0cigncmVhZG9ubHknLCB0cnVlKTtcblx0XHR9KTtcblx0XHRNb2R1bGVQaG9uZUJvb2suZGF0YVRhYmxlLnNlYXJjaCh0ZXh0KS5kcmF3KCk7XG5cdFx0TW9kdWxlUGhvbmVCb29rLiRnbG9iYWxTZWFyY2guY2xvc2VzdCgnZGl2JykuYWRkQ2xhc3MoJ2xvYWRpbmcnKTtcblx0fSxcblx0LyoqXG5cdCAqINCe0YfQuNGB0YLQutCwINC90L7QvNC10YDQsCDQv9C10YDQtdC0INCy0YHRgtCw0LLQutC+0Lkg0L7RgiDQu9C40YjQvdC40YUg0YHQuNC80LLQvtC70L7QslxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbnwqfHZvaWR8c3RyaW5nfVxuXHQgKi9cblx0Y2JPbk51bWJlckJlZm9yZVBhc3RlKHBhc3RlZFZhbHVlKSB7XG5cdFx0cmV0dXJuIHBhc3RlZFZhbHVlLnJlcGxhY2UoL1xcRCsvZywgJycpO1xuXHR9LFxuXHQvKipcblx0ICog0KPQtNCw0LvQtdC90LjQtSDRgdGC0YDQvtC60Lhcblx0ICogQHBhcmFtICR0YXJnZXQgLSBqcXVlcnkgYnV0dG9uIHRhcmdldFxuXHQgKiBAcGFyYW0gaWQgLSByZWNvcmQgaWRcblx0ICovXG5cdGRlbGV0ZVJvdygkdGFyZ2V0LCBpZCkge1xuXHRcdGlmIChpZCA9PT0gJ25ldycpIHtcblx0XHRcdCR0YXJnZXQuY2xvc2VzdCgndHInKS5yZW1vdmUoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0JC5hcGkoe1xuXHRcdFx0dXJsOiBgJHtnbG9iYWxSb290VXJsfW1vZHVsZS1waG9uZS1ib29rL2RlbGV0ZS8ke2lkfWAsXG5cdFx0XHRvbjogJ25vdycsXG5cdFx0XHRvblN1Y2Nlc3MocmVzcG9uc2UpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHtcblx0XHRcdFx0XHQkdGFyZ2V0LmNsb3Nlc3QoJ3RyJykucmVtb3ZlKCk7XG5cdFx0XHRcdFx0aWYgKE1vZHVsZVBob25lQm9vay4kcmVjb3Jkc1RhYmxlLmZpbmQoJ3Rib2R5ID4gdHInKS5sZW5ndGg9PT0wKXtcblx0XHRcdFx0XHRcdE1vZHVsZVBob25lQm9vay4kcmVjb3Jkc1RhYmxlLmZpbmQoJ3Rib2R5JykuYXBwZW5kKCc8dHIgY2xhc3M9XCJvZGRcIj48L3RyPicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHR9KTtcblx0fSxcbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcblx0TW9kdWxlUGhvbmVCb29rLmluaXRpYWxpemUoKTtcbn0pO1xuIl19